sectionID,sectionTitle,conversationID,questionID,question,vars,queries,program,answer,folder_name
1,simple,2,1,Was Caterpillar's average total revenue higher or lower than Realogy's lowest net income from 2019 to 2021?,"{'company_1': {'mention': 'Caterpillar', 'name': 'CATERPILLAR INC'}, 'company_2': {'mention': 'Realogy', 'name': 'Realogy Holdings Corp.'}, 'concept_1': {'mention': 'total revenue', 'name': 'us-gaap:Revenues'}, 'concept_2': {'mention': 'net income', 'name': 'us-gaap:ProfitLoss'}, 'year_1': 2019, 'year_2': 2021}","{'var_q1_p1': 'WITH [""CATERPILLAR INC""] AS companies, [""us-gaap:Revenues""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q1_p2': 'WITH [""Realogy Holdings Corp.""] AS companies, [""us-gaap:ProfitLoss""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q1_p1 = get_company_facts(company_1, concept_1, start=year_1, end=year_2)', 'var_q1_p2 = get_company_facts(company_2, concept_2, start=year_1, end=year_2)', ""var_q1_p3 = mean(var_q1_p1, axis='columns', level=null)"", ""var_q1_p4 = sort(var_q1_p2, ascending=True, axis='columns', by=[['Realogy Holdings Corp.','us-gaap:ProfitLoss']])"", ""var_q1_p5 = k_end(var_q1_p4, axis='rows', direction='first', k=1)"", ""var_q1_p6 = merge(var_q1_p5, axis='rows', dfs=[var_q1_p3], ignore_index=False)"", ""var_q1_p7 = compare(var_q1_p6, axis='rows')""]",higher,chat-1-01
1,simple,2,2,By how much?,"{'company_1': {'mention': 'Caterpillar', 'name': 'CATERPILLAR INC'}, 'company_2': {'mention': 'Realogy', 'name': 'Realogy Holdings Corp.'}, 'concept_1': {'mention': 'total revenue', 'name': 'us-gaap:Revenues'}, 'concept_2': {'mention': 'net income', 'name': 'us-gaap:ProfitLoss'}, 'year_1': 2019, 'year_2': 2021}","{'var_q2_p1': 'WITH [""CATERPILLAR INC""] AS companies, [""us-gaap:Revenues""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q2_p2': 'WITH [""Realogy Holdings Corp.""] AS companies, [""us-gaap:ProfitLoss""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q2_p1 = get_company_facts(company_1, concept_1, start=year_1, end=year_2)', 'var_q2_p2 = get_company_facts(company_2, concept_2, start=year_1, end=year_2)', ""var_q2_p3 = mean(var_q2_p1, axis='columns', level=null)"", ""var_q2_p4 = sort(var_q2_p2, ascending=True, axis='columns', by=[['Realogy Holdings Corp.','us-gaap:ProfitLoss']])"", ""var_q2_p5 = k_end(var_q2_p4, axis='rows', direction='first', k=1)"", ""var_q2_p6 = merge(var_q2_p5, axis='rows', dfs=[var_q2_p3], ignore_index=False)"", ""var_q2_p7 = diff(var_q2_p6, axis='rows')"", 'var_q2_p8 = abs(var_q2_p7, )']",48654666666.67,chat-1-01
1,simple,2,3,"Comparing to the highest net income, how much?","{'company_1': {'mention': 'Caterpillar', 'name': 'CATERPILLAR INC'}, 'company_2': {'mention': 'Realogy', 'name': 'Realogy Holdings Corp.'}, 'concept_1': {'mention': 'total revenue', 'name': 'us-gaap:Revenues'}, 'concept_2': {'mention': 'net income', 'name': 'us-gaap:ProfitLoss'}, 'year_1': 2019, 'year_2': 2021}","{'var_q3_p1': 'WITH [""CATERPILLAR INC""] AS companies, [""us-gaap:Revenues""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q3_p2': 'WITH [""Realogy Holdings Corp.""] AS companies, [""us-gaap:ProfitLoss""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q3_p1 = get_company_facts(company_1, concept_1, start=year_1, end=year_2)', 'var_q3_p2 = get_company_facts(company_2, concept_2, start=year_1, end=year_2)', ""var_q3_p3 = mean(var_q3_p1, axis='columns', level=null)"", ""var_q3_p4 = sort(var_q3_p2, ascending=False, axis='columns', by=[['Realogy Holdings Corp.','us-gaap:ProfitLoss']])"", ""var_q3_p5 = k_end(var_q3_p4, axis='rows', direction='first', k=1)"", ""var_q3_p6 = merge(var_q3_p5, axis='rows', dfs=[var_q3_p3], ignore_index=False)"", ""var_q3_p7 = diff(var_q3_p6, axis='rows')"", 'var_q3_p8 = abs(var_q3_p7, )']",48483666666.67,chat-1-01
1,simple,2,4,What about sum instead of average?,"{'company_1': {'mention': 'Caterpillar', 'name': 'CATERPILLAR INC'}, 'company_2': {'mention': 'Realogy', 'name': 'Realogy Holdings Corp.'}, 'concept_1': {'mention': 'total revenue', 'name': 'us-gaap:Revenues'}, 'concept_2': {'mention': 'net income', 'name': 'us-gaap:ProfitLoss'}, 'year_1': 2019, 'year_2': 2021}","{'var_q4_p1': 'WITH [""CATERPILLAR INC""] AS companies, [""us-gaap:Revenues""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q4_p2': 'WITH [""Realogy Holdings Corp.""] AS companies, [""us-gaap:ProfitLoss""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q4_p1 = get_company_facts(company_1, concept_1, start=year_1, end=year_2)', 'var_q4_p2 = get_company_facts(company_2, concept_2, start=year_1, end=year_2)', ""var_q4_p3 = sum(var_q4_p1, axis='columns', level=null)"", ""var_q4_p4 = sort(var_q4_p2, ascending=False, axis='columns', by=[['Realogy Holdings Corp.','us-gaap:ProfitLoss']])"", ""var_q4_p5 = k_end(var_q4_p4, axis='rows', direction='first', k=1)"", ""var_q4_p6 = merge(var_q4_p5, axis='rows', dfs=[var_q4_p3], ignore_index=False)"", ""var_q4_p7 = diff(var_q4_p6, axis='rows')"", 'var_q4_p8 = abs(var_q4_p7, )']",146163000000,chat-1-01
1,simple,2,5,Sum of Piedmont Office Realty Trust's total revenue instead of Caterpillar,"{'company_3': {'mention': 'Piedmont Office Realty Trust', 'name': 'Piedmont Office Realty Trust, Inc.'}, 'company_1': {'mention': 'Caterpillar', 'name': 'CATERPILLAR INC'}, 'company_2': {'mention': 'Realogy', 'name': 'Realogy Holdings Corp.'}, 'concept_1': {'mention': 'total revenue', 'name': 'us-gaap:Revenues'}, 'concept_2': {'mention': 'net income', 'name': 'us-gaap:ProfitLoss'}, 'year_1': 2019, 'year_2': 2021}","{'var_q5_p1': 'WITH [""Piedmont Office Realty Trust, Inc.""] AS companies, [""us-gaap:Revenues""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q5_p2': 'WITH [""Realogy Holdings Corp.""] AS companies, [""us-gaap:ProfitLoss""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q5_p1 = get_company_facts(company_3, concept_1, start=year_1, end=year_2)', 'var_q5_p2 = get_company_facts(company_2, concept_2, start=year_1, end=year_2)', ""var_q5_p3 = sum(var_q5_p1, axis='columns', level=null)"", ""var_q5_p4 = sort(var_q5_p2, ascending=False, axis='columns', by=[['Realogy Holdings Corp.','us-gaap:ProfitLoss']])"", ""var_q5_p5 = k_end(var_q5_p4, axis='rows', direction='first', k=1)"", ""var_q5_p6 = merge(var_q5_p5, axis='rows', dfs=[var_q5_p3], ignore_index=False)"", ""var_q5_p7 = diff(var_q5_p6, axis='rows')"", 'var_q5_p8 = abs(var_q5_p7, )']",1240912000,chat-1-01
1,simple,2,6,2018 to 2022 instead of 2019 to 2021,"{'year_3': 2018, 'year_4': 2022, 'company_3': {'mention': 'Piedmont Office Realty Trust', 'name': 'Piedmont Office Realty Trust, Inc.'}, 'company_1': {'mention': 'Caterpillar', 'name': 'CATERPILLAR INC'}, 'company_2': {'mention': 'Realogy', 'name': 'Realogy Holdings Corp.'}, 'concept_1': {'mention': 'total revenue', 'name': 'us-gaap:Revenues'}, 'concept_2': {'mention': 'net income', 'name': 'us-gaap:ProfitLoss'}, 'year_1': 2019, 'year_2': 2021}","{'var_q6_p1': 'WITH [""Piedmont Office Realty Trust, Inc.""] AS companies, [""us-gaap:Revenues""] AS concepts, [2018, 2019, 2020, 2021, 2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q6_p2': 'WITH [""Realogy Holdings Corp.""] AS companies, [""us-gaap:ProfitLoss""] AS concepts, [2018, 2019, 2020, 2021, 2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q6_p1 = get_company_facts(company_3, concept_1, start=year_3, end=year_4)', 'var_q6_p2 = get_company_facts(company_2, concept_2, start=year_3, end=year_4)', ""var_q6_p3 = sum(var_q6_p1, axis='columns', level=null)"", ""var_q6_p4 = sort(var_q6_p2, ascending=False, axis='columns', by=[['Realogy Holdings Corp.','us-gaap:ProfitLoss']])"", ""var_q6_p5 = k_end(var_q6_p4, axis='rows', direction='first', k=1)"", ""var_q6_p6 = merge(var_q6_p5, axis='rows', dfs=[var_q6_p3], ignore_index=False)"", ""var_q6_p7 = diff(var_q6_p6, axis='rows')"", 'var_q6_p8 = abs(var_q6_p7, )']",2330645000,chat-1-01
1,simple,2,7,What would be the sum if 2022 was not included?,"{'year_5': 2021, 'year_3': 2018, 'year_4': 2022, 'company_3': {'mention': 'Piedmont Office Realty Trust', 'name': 'Piedmont Office Realty Trust, Inc.'}, 'company_1': {'mention': 'Caterpillar', 'name': 'CATERPILLAR INC'}, 'company_2': {'mention': 'Realogy', 'name': 'Realogy Holdings Corp.'}, 'concept_1': {'mention': 'total revenue', 'name': 'us-gaap:Revenues'}, 'concept_2': {'mention': 'net income', 'name': 'us-gaap:ProfitLoss'}, 'year_1': 2019, 'year_2': 2021}","{'var_q7_p1': 'WITH [""Piedmont Office Realty Trust, Inc.""] AS companies, [""us-gaap:Revenues""] AS concepts, [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q7_p1 = get_company_facts(company_3, concept_1, start=year_3, end=year_5)', ""var_q7_p2 = sum(var_q7_p1, axis='columns', level=null)""]",2122879000,chat-1-01
1,simple,2,8,How much different was Caterpillar's sum to Realogy for the same years?,"{'year_5': 2021, 'year_3': 2018, 'year_4': 2022, 'company_3': {'mention': 'Piedmont Office Realty Trust', 'name': 'Piedmont Office Realty Trust, Inc.'}, 'company_1': {'mention': 'Caterpillar', 'name': 'CATERPILLAR INC'}, 'company_2': {'mention': 'Realogy', 'name': 'Realogy Holdings Corp.'}, 'concept_1': {'mention': 'total revenue', 'name': 'us-gaap:Revenues'}, 'concept_2': {'mention': 'net income', 'name': 'us-gaap:ProfitLoss'}, 'year_1': 2019, 'year_2': 2021}","{'var_q8_p1': 'WITH [""CATERPILLAR INC"", ""Realogy Holdings Corp.""] AS companies, [""us-gaap:Revenues""] AS concepts, [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q8_p1 = get_company_facts([company_1, company_2], concept_1, start=year_3, end=year_5)', ""var_q8_p2 = sum(var_q8_p1, axis='columns', level=null)"", ""var_q8_p3 = diff(var_q8_p2, axis='rows')"", 'var_q8_p4 = abs(var_q8_p3, )']",175088000000,chat-1-01
1,simple,2,9,What would it be if 2022 was not excluded?,"{'year_5': 2021, 'year_3': 2018, 'year_4': 2022, 'company_3': {'mention': 'Piedmont Office Realty Trust', 'name': 'Piedmont Office Realty Trust, Inc.'}, 'company_1': {'mention': 'Caterpillar', 'name': 'CATERPILLAR INC'}, 'company_2': {'mention': 'Realogy', 'name': 'Realogy Holdings Corp.'}, 'concept_1': {'mention': 'total revenue', 'name': 'us-gaap:Revenues'}, 'concept_2': {'mention': 'net income', 'name': 'us-gaap:ProfitLoss'}, 'year_1': 2019, 'year_2': 2021}","{'var_q9_p1': 'WITH [""CATERPILLAR INC"", ""Realogy Holdings Corp.""] AS companies, [""us-gaap:Revenues""] AS concepts, [2018, 2019, 2020, 2021, 2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q9_p1 = get_company_facts([company_1, company_2], concept_1, start=year_3, end=year_4)', ""var_q9_p2 = sum(var_q9_p1, axis='columns', level=null)"", ""var_q9_p3 = diff(var_q9_p2, axis='rows')""]",227607000000,chat-1-01
1,simple,2,10,List the differences by year (do not sum),"{'year_5': 2021, 'year_3': 2018, 'year_4': 2022, 'company_3': {'mention': 'Piedmont Office Realty Trust', 'name': 'Piedmont Office Realty Trust, Inc.'}, 'company_1': {'mention': 'Caterpillar', 'name': 'CATERPILLAR INC'}, 'company_2': {'mention': 'Realogy', 'name': 'Realogy Holdings Corp.'}, 'concept_1': {'mention': 'total revenue', 'name': 'us-gaap:Revenues'}, 'concept_2': {'mention': 'net income', 'name': 'us-gaap:ProfitLoss'}, 'year_1': 2019, 'year_2': 2021}","{'var_q10_p1': 'WITH [""CATERPILLAR INC"", ""Realogy Holdings Corp.""] AS companies, [""us-gaap:Revenues""] AS concepts, [2018, 2019, 2020, 2021, 2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE o.name IN companies AND c.name IN concepts AND f.year IN years RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q10_p1 = get_company_facts([company_1, company_2], concept_1, start=year_3, end=year_4)', ""var_q10_p2 = diff(var_q10_p1, axis='rows')"", 'var_q10_p3 = abs(var_q10_p2, )']","{'2018': 48643000000, '2019': 47930000000, '2020': 35527000000, '2021': 42988000000, '2022': 52519000000}",chat-1-01
2,complex,3,1,"Among companies reporting combined corporate overhead expenses of at least 300M during the four-year period starting from 2018, what is their overall average?","{'num_1': '300M', 'num_2': 'four', 'year_1': 2018, 'year_2': 2021, 'concept_1': {'mention': 'corporate overhead expenses', 'name': 'us-gaap:GeneralAndAdministrativeExpense'}}","{'var_q1_p1': 'WITH [""us-gaap:GeneralAndAdministrativeExpense""] AS concepts, [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","[""var_q1_p1 = filter_companies_by_facts(f'f.number &gt;= {num_1}', concept_1, start=year_1, end=year_2)"", ""var_q1_p2 = sum(var_q1_p1, axis='columns', keep_col=false, level=null)"", ""var_q1_p3 = loc_filter(var_q1_p2, axis='columns', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q1_p2, val='300m')"", ""var_q1_p4 = mean(var_q1_p3, axis='rows', keep_col=false, level=null, skipna=true)""]",1801658954.34,chat-2-01
2,complex,3,2,How many companies are included?,"{'num_1': '300M', 'num_2': 'four', 'year_1': 2018, 'year_2': 2021, 'concept_1': {'mention': 'corporate overhead expenses', 'name': 'us-gaap:GeneralAndAdministrativeExpense'}}","{'var_q2_p1': 'WITH [""us-gaap:GeneralAndAdministrativeExpense""] AS concepts, [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q2_p1 = filter_companies_by_facts(None, concept_1, start=year_1, end=year_2)', ""var_q2_p2 = sum(var_q2_p1, axis='columns', keep_col=false, level=null)"", ""var_q2_p3 = loc_filter(var_q2_p2, axis='columns', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q2_p2, val='300m')"", ""var_q2_p4 = count(var_q2_p3, axis='rows')""]",318,chat-2-01
2,complex,3,3,How many of them reported investments in marketable equity securities of more than 500M in 2022?,"{'num_3': '500M', 'year_3': 2022, 'concept_2': {'mention': 'investments in marketable equity securities', 'name': 'us-gaap:MarketableSecurities'}, 'num_1': '300M', 'num_2': 'four', 'year_1': 2018, 'year_2': 2021, 'concept_1': {'mention': 'corporate overhead expenses', 'name': 'us-gaap:GeneralAndAdministrativeExpense'}}","{'var_q3_p1': 'WITH [""us-gaap:GeneralAndAdministrativeExpense""] AS concepts, [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q3_p2': 'WITH [""us-gaap:MarketableSecurities""] AS concepts, [2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q3_p1 = filter_companies_by_facts(None, concept_1, start=year_1, end=year_2)', 'var_q3_p2 = filter_companies_by_facts(None, concept_2, years=[year_3])', ""var_q3_p3 = sum(var_q3_p1, axis='columns', keep_col=false, level=null)"", ""var_q3_p4 = loc_filter(var_q3_p3, axis='columns', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q3_p3, val='300m')"", ""var_q3_p5 = intersect(var_q3_p2, axis='rows', dfs=[var_q3_p4], level=0)"", ""var_q3_p6 = loc_filter(var_q3_p5, axis='columns', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q3_p5, val='500m')"", ""var_q3_p7 = count(var_q3_p6, axis='columns')""]",2,chat-2-01
2,complex,3,4,Calculate the overall average investments in marketable equity securities the same way you did in the first question with 3B as the threshold.,"{'num_4': '3B', 'num_3': '500M', 'year_3': 2022, 'concept_2': {'mention': 'investments in marketable equity securities', 'name': 'us-gaap:MarketableSecurities'}, 'num_1': '300M', 'num_2': 'four', 'year_1': 2018, 'year_2': 2021, 'concept_1': {'mention': 'corporate overhead expenses', 'name': 'us-gaap:GeneralAndAdministrativeExpense'}}","{'var_q4_p1': 'WITH [""us-gaap:MarketableSecurities""] AS concepts, [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q4_p1 = filter_companies_by_facts(None, concept_2, start=year_1, end=year_2)', ""var_q4_p2 = sum(var_q4_p1, axis='columns', keep_col=false, level=null)"", ""var_q4_p3 = loc_filter(var_q4_p2, axis='rows', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q4_p2, val='3b')"", ""var_q4_p4 = mean(var_q4_p3, axis='rows', keep_col=false, level=null, skipna=true)""]",45829027128.21,chat-2-01
2,complex,3,5,Are there more or less companies reporting investments in marketable equity securities above the threshold in 2021 compared to 2022?,"{'year_4': 2021, 'num_4': '3B', 'num_3': '500M', 'year_3': 2022, 'concept_2': {'mention': 'investments in marketable equity securities', 'name': 'us-gaap:MarketableSecurities'}, 'num_1': '300M', 'num_2': 'four', 'year_1': 2018, 'year_2': 2021, 'concept_1': {'mention': 'corporate overhead expenses', 'name': 'us-gaap:GeneralAndAdministrativeExpense'}}","{'var_q5_p1': 'WITH [""us-gaap:MarketableSecurities""] AS concepts, [2022, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q5_p1 = filter_companies_by_facts(None, concept_2, years=[year_3, year_4])', 'var_q5_p2 = loc(var_q5_p1, columns=""[2021, ]"", idx="":, :"")', ""var_q5_p3 = loc_filter(var_q5_p2, axis='columns', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q5_p2, val='3b')"", ""var_q5_p4 = count(var_q5_p3, axis='columns')"", 'var_q5_p5 = loc(var_q5_p1, columns=""[2022, ]"", idx="":, :"")', ""var_q5_p6 = loc_filter(var_q5_p5, axis='columns', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q5_p5, val='3b')"", ""var_q5_p7 = count(var_q5_p6, axis='columns')"", ""var_q5_p8 = merge(var_q5_p7, axis='rows', dfs=[var_q5_p4], ignore_index=True, replace_columns=True)"", ""var_q5_p9 = compare(var_q5_p8, axis='rows')""]",more,chat-2-01
2,complex,3,6,"Instead of comparing, what is the ratio of 2021 to 2022?","{'year_4': 2021, 'num_4': '3B', 'num_3': '500M', 'year_3': 2022, 'concept_2': {'mention': 'investments in marketable equity securities', 'name': 'us-gaap:MarketableSecurities'}, 'num_1': '300M', 'num_2': 'four', 'year_1': 2018, 'year_2': 2021, 'concept_1': {'mention': 'corporate overhead expenses', 'name': 'us-gaap:GeneralAndAdministrativeExpense'}}","{'var_q6_p1': 'WITH [""us-gaap:MarketableSecurities""] AS concepts, [2022, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q6_p1 = filter_companies_by_facts(None, concept_2, years=[year_3, year_4])', 'var_q6_p2 = loc(var_q6_p1, columns=""[2021, ]"", idx="":, :"")', ""var_q6_p3 = loc_filter(var_q6_p2, axis='columns', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q6_p2, val='3b')"", ""var_q6_p4 = count(var_q6_p3, axis='columns')"", 'var_q6_p5 = loc(var_q6_p1, columns=""[2022, ]"", idx="":, :"")', ""var_q6_p6 = loc_filter(var_q6_p5, axis='columns', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q6_p5, val='3b')"", ""var_q6_p7 = count(var_q6_p6, axis='columns')"", ""var_q6_p8 = merge(var_q6_p7, axis='rows', dfs=[var_q6_p4], ignore_index=True, replace_columns=True)"", ""var_q6_p9 = div(var_q6_p8, axis='rows', keep_col=True)""]",1.21,chat-2-01
2,complex,3,7,Change the threshold to 800M and below. What's the ratio?,"{'num_5': '800M', 'year_4': 2021, 'num_4': '3B', 'num_3': '500M', 'year_3': 2022, 'concept_2': {'mention': 'investments in marketable equity securities', 'name': 'us-gaap:MarketableSecurities'}, 'num_1': '300M', 'num_2': 'four', 'year_1': 2018, 'year_2': 2021, 'concept_1': {'mention': 'corporate overhead expenses', 'name': 'us-gaap:GeneralAndAdministrativeExpense'}}","{'var_q7_p1': 'WITH [""us-gaap:MarketableSecurities""] AS concepts, [2022, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q7_p1 = filter_companies_by_facts(None, concept_2, years=[year_3, year_4])', 'var_q7_p2 = loc(var_q7_p1, columns=""[2021, ]"", idx="":, :"")', ""var_q7_p3 = loc_filter(var_q7_p2, axis='columns', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q7_p2, val='800m')"", ""var_q7_p4 = loc_filter(var_q7_p3, axis='columns', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q7_p3, val='0')"", ""var_q7_p5 = count(var_q7_p4, axis='columns')"", 'var_q7_p6 = loc(var_q7_p1, columns=""[2022, ]"", idx="":, :"")', ""var_q7_p7 = loc_filter(var_q7_p6, axis='columns', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q7_p6, val='800m')"", ""var_q7_p8 = loc_filter(var_q7_p7, axis='columns', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q7_p7, val='0')"", ""var_q7_p9 = count(var_q7_p8, axis='columns')"", ""var_q7_p10 = merge(var_q7_p9, axis='rows', dfs=[var_q7_p5], ignore_index=True, replace_columns=True)"", ""var_q7_p11 = div(var_q7_p10, axis='rows', keep_col=True)""]",1.21,chat-2-01
2,complex,3,8,What is the 2022 average for those within the threshold?,"{'num_5': '800M', 'year_4': 2021, 'num_4': '3B', 'num_3': '500M', 'year_3': 2022, 'concept_2': {'mention': 'investments in marketable equity securities', 'name': 'us-gaap:MarketableSecurities'}, 'num_1': '300M', 'num_2': 'four', 'year_1': 2018, 'year_2': 2021, 'concept_1': {'mention': 'corporate overhead expenses', 'name': 'us-gaap:GeneralAndAdministrativeExpense'}}","{'var_q8_p1': 'WITH [""us-gaap:MarketableSecurities""] AS concepts, [2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q8_p1 = filter_companies_by_facts(None, concept_1, years=[year_3])', ""var_q8_p2 = loc_filter(var_q8_p1, axis='columns', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q8_p1, val='800m')"", ""var_q8_p3 = loc_filter(var_q8_p2, axis='columns', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q8_p2, val='0')"", ""var_q8_p4 = mean(var_q8_p3, axis='rows', keep_col=false, level=null, skipna=true)""]",179135926.47,chat-2-01
2,complex,3,9,And for 2021?,"{'num_5': '800M', 'year_4': 2021, 'num_4': '3B', 'num_3': '500M', 'year_3': 2022, 'concept_2': {'mention': 'investments in marketable equity securities', 'name': 'us-gaap:MarketableSecurities'}, 'num_1': '300M', 'num_2': 'four', 'year_1': 2018, 'year_2': 2021, 'concept_1': {'mention': 'corporate overhead expenses', 'name': 'us-gaap:GeneralAndAdministrativeExpense'}}","{'var_q9_p1': 'WITH [""us-gaap:MarketableSecurities""] AS concepts, [2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q9_p1 = filter_companies_by_facts(None, concept_2, years=[year_4])', ""var_q9_p2 = loc_filter(var_q9_p1, axis='columns', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q9_p1, val='800m')"", ""var_q9_p3 = mean(var_q9_p2, axis='rows', keep_col=false, level=null, skipna=true)""]",174717387.57,chat-2-01
2,complex,3,10,"Which year is higher, 2022 or 2021?","{'num_5': '800M', 'year_4': 2021, 'num_4': '3B', 'num_3': '500M', 'year_3': 2022, 'concept_2': {'mention': 'investments in marketable equity securities', 'name': 'us-gaap:MarketableSecurities'}, 'num_1': '300M', 'num_2': 'four', 'year_1': 2018, 'year_2': 2021, 'concept_1': {'mention': 'corporate overhead expenses', 'name': 'us-gaap:GeneralAndAdministrativeExpense'}}","{'var_q10_p1': 'WITH [""us-gaap:MarketableSecurities""] AS concepts, [2022, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q10_p1 = filter_companies_by_facts(None, concept_2, years=[year_3, year_4])', 'var_q10_p2 = loc(var_q10_p1, columns=""[2021, ]"", idx="":, :"")', ""var_q10_p3 = loc_filter(var_q10_p2, axis='columns', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q10_p2, val='800m')"", ""var_q10_p4 = mean(var_q10_p3, axis='rows', keep_col=false, level=null, skipna=true)"", 'var_q10_p5 = loc(var_q10_p1, columns=""[2022, ]"", idx="":, :"")', ""var_q10_p6 = loc_filter(var_q10_p5, axis='columns', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q10_p5, val='800m')"", ""var_q10_p7 = mean(var_q10_p6, axis='rows', keep_col=false, level=null, skipna=true)"", ""var_q10_p8 = merge(var_q10_p7, axis='rows', dfs=[var_q10_p4], ignore_index=False, replace_columns=True)"", ""var_q10_p9 = sort(var_q10_p8, ascending=False, axis='rows', by=[])"", ""var_q10_p10 = k_end(var_q10_p9, axis='rows', direction='first', k='1', reverse=false)"", ""var_q10_p11 = headers(var_q10_p10, axis='rows', level=null)""]",2022,chat-2-01
3,multi-hop,4,1,What are the top three companies by security deposits in the pharmaceutical preparations industry from 2020 to 2022 combined?,"{'num_1': 'three', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'security deposits', 'name': 'us-gaap:SecurityDeposit'}, 'industry_1': {'mention': 'pharmaceutical preparations', 'name': 'PHARMACEUTICAL PREPARATIONS'}}","{'var_q1_p1': 'WITH [2020, 2021, 2022] AS years, [""PHARMACEUTICAL PREPARATIONS""] AS industries MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, f.year AS year, f.number as value ORDER BY industry, company'}","['var_q1_p1 = query_b021q01p01(concept_1, [industry_1], year_1, year_2)', ""var_q1_p2 = sum(var_q1_p1, axis='columns', keep_col=false, level=null)"", ""var_q1_p3 = sort(var_q1_p2, ascending=False, axis='rows', by=[])"", ""var_q1_p4 = k_end(var_q1_p3, axis='rows', direction='first', k=3, reverse=false)"", ""var_q1_p5 = headers(var_q1_p4, axis='rows', level=1)""]","['INTERCEPT PHARMACEUTICALS, INC.', 'Mirati Therapeutics, Inc.', 'Arcus Biosciences, Inc.']",chat-3-01
3,multi-hop,4,2,Is their average of combined security deposits higher or lower than the top three in the real estate investment trusts industry during the same years?,"{'industry_2': {'mention': 'real estate investment trusts', 'name': 'REAL ESTATE INVESTMENT TRUSTS'}, 'num_1': 'three', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'security deposits', 'name': 'us-gaap:SecurityDeposit'}, 'industry_1': {'mention': 'pharmaceutical preparations', 'name': 'PHARMACEUTICAL PREPARATIONS'}}","{'var_q2_p1': 'WITH [2020, 2021, 2022] AS years, [""PHARMACEUTICAL PREPARATIONS""] AS industries MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, f.year AS year, f.number as value ORDER BY industry, company', 'var_q2_p2': 'WITH [2020, 2021, 2022] AS years, [""REAL ESTATE INVESTMENT TRUSTS""] AS industries MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, f.year AS year, f.number as value ORDER BY industry, company'}","['var_q2_p1 = query_b021q01p01(concept_1, [industry_1], year_1, year_2)', 'var_q2_p2 = query_b021q01p01(concept_1, [industry_2], year_1, year_2)', ""var_q2_p3 = sum(var_q2_p2, axis='columns', keep_col=false, level=null)"", ""var_q2_p4 = sort(var_q2_p3, ascending=False, axis='rows', by=[])"", ""var_q2_p5 = k_end(var_q2_p4, axis='rows', direction='first', k=3, reverse=false)"", ""var_q2_p6 = mean(var_q2_p5, axis='rows', keep_col=false, level=null, skipna=true)"", ""var_q2_p7 = sum(var_q2_p1, axis='columns', keep_col=false, level=null)"", ""var_q2_p8 = sort(var_q2_p7, ascending=False, axis='rows', by=[])"", ""var_q2_p9 = k_end(var_q2_p8, axis='rows', direction='first', k=3, reverse=false)"", ""var_q2_p10 = mean(var_q2_p9, axis='rows', keep_col=false, level=null, skipna=true)"", ""var_q2_p11 = merge(var_q2_p6, axis='rows', dfs=[var_q2_p10], ignore_index=True, replace_columns=True)"", ""var_q2_p12 = compare(var_q2_p11, axis='rows')""]",lower,chat-3-01
3,multi-hop,4,3,How much is that difference?,"{'industry_2': {'mention': 'real estate investment trusts', 'name': 'REAL ESTATE INVESTMENT TRUSTS'}, 'num_1': 'three', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'security deposits', 'name': 'us-gaap:SecurityDeposit'}, 'industry_1': {'mention': 'pharmaceutical preparations', 'name': 'PHARMACEUTICAL PREPARATIONS'}}","{'var_q3_p1': 'WITH [2020, 2021, 2022] AS years, [""PHARMACEUTICAL PREPARATIONS""] AS industries MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, f.year AS year, f.number as value ORDER BY industry, company', 'var_q3_p2': 'WITH [2020, 2021, 2022] AS years, [""REAL ESTATE INVESTMENT TRUSTS""] AS industries MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, f.year AS year, f.number as value ORDER BY industry, company'}","['var_q3_p1 = query_b021q01p01(concept_1, [industry_1], year_1, year_2)', 'var_q3_p2 = query_b021q01p01(concept_1, [industry_2], year_1, year_2)', ""var_q3_p3 = sum(var_q3_p2, axis='columns', keep_col=false, level=null)"", ""var_q3_p4 = sort(var_q3_p3, ascending=False, axis='rows', by=[])"", ""var_q3_p5 = k_end(var_q3_p4, axis='rows', direction='first', k=3, reverse=false)"", ""var_q3_p6 = mean(var_q3_p5, axis='rows', keep_col=false, level=null, skipna=true)"", ""var_q3_p7 = sum(var_q3_p1, axis='columns', keep_col=false, level=null)"", ""var_q3_p8 = sort(var_q3_p7, ascending=False, axis='rows', by=[])"", ""var_q3_p9 = k_end(var_q3_p8, axis='rows', direction='first', k=3, reverse=false)"", ""var_q3_p10 = mean(var_q3_p9, axis='rows', keep_col=false, level=null, skipna=true)"", ""var_q3_p11 = merge(var_q3_p6, axis='rows', dfs=[var_q3_p10], ignore_index=True, replace_columns=True)"", ""var_q3_p12 = diff(var_q3_p11, axis='rows')"", 'var_q3_p13 = abs(var_q3_p12, )']",35121000,chat-3-01
3,multi-hop,4,4,"What about the top two, how much?","{'num_2': 'two', 'industry_2': {'mention': 'real estate investment trusts', 'name': 'REAL ESTATE INVESTMENT TRUSTS'}, 'num_1': 'three', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'security deposits', 'name': 'us-gaap:SecurityDeposit'}, 'industry_1': {'mention': 'pharmaceutical preparations', 'name': 'PHARMACEUTICAL PREPARATIONS'}}","{'var_q4_p1': 'WITH [2020, 2021, 2022] AS years, [""PHARMACEUTICAL PREPARATIONS""] AS industries MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, f.year AS year, f.number as value ORDER BY industry, company', 'var_q4_p2': 'WITH [2020, 2021, 2022] AS years, [""REAL ESTATE INVESTMENT TRUSTS""] AS industries MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, f.year AS year, f.number as value ORDER BY industry, company'}","['var_q4_p1 = query_b021q01p01(concept_1, [industry_1], year_1, year_2)', 'var_q4_p2 = query_b021q01p01(concept_1, [industry_2], year_1, year_2)', ""var_q4_p3 = sum(var_q4_p2, axis='columns', keep_col=false, level=null)"", ""var_q4_p4 = sort(var_q4_p3, ascending=False, axis='rows', by=[])"", ""var_q4_p5 = k_end(var_q4_p4, axis='rows', direction='first', k='2', reverse=false)"", ""var_q4_p6 = mean(var_q4_p5, axis='rows', keep_col=false, level=null, skipna=true)"", ""var_q4_p7 = sum(var_q4_p1, axis='columns', keep_col=false, level=null)"", ""var_q4_p8 = sort(var_q4_p7, ascending=False, axis='rows', by=[])"", ""var_q4_p9 = k_end(var_q4_p8, axis='rows', direction='first', k='2', reverse=false)"", ""var_q4_p10 = mean(var_q4_p9, axis='rows', keep_col=false, level=null, skipna=true)"", ""var_q4_p11 = merge(var_q4_p6, axis='rows', dfs=[var_q4_p10], ignore_index=True, replace_columns=True)"", ""var_q4_p12 = diff(var_q4_p11, axis='rows')"", 'var_q4_p13 = abs(var_q4_p12, )']",52083000,chat-3-01
3,multi-hop,4,5,Forget about the top two. I only want those in New York. How much is the difference?,"{'location_1': {'mention': 'New York', 'name': 'NEW YORK'}, 'num_2': 'two', 'industry_2': {'mention': 'real estate investment trusts', 'name': 'REAL ESTATE INVESTMENT TRUSTS'}, 'num_1': 'three', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'security deposits', 'name': 'us-gaap:SecurityDeposit'}, 'industry_1': {'mention': 'pharmaceutical preparations', 'name': 'PHARMACEUTICAL PREPARATIONS'}}","{'var_q5_p1': 'WITH [2020, 2021, 2022] AS years, [""PHARMACEUTICAL PREPARATIONS""] AS industries, [""NEW YORK""] AS locations MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry), (o)-[:HAS_STATE_LOCATION]->(s:State) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND s.name IN locations AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, s.name AS location, f.year AS year, f.number as value ORDER BY industry, company', 'var_q5_p2': 'WITH [2020, 2021, 2022] AS years, [""REAL ESTATE INVESTMENT TRUSTS""] AS industries, [""NEW YORK""] AS locations MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry), (o)-[:HAS_STATE_LOCATION]->(s:State) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND s.name IN locations AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, s.name AS location, f.year AS year, f.number as value ORDER BY industry, company'}","['var_q5_p1 = query_b021q05p01(concept_1, [industry_1], [location_1], year_1, year_2)', 'var_q5_p2 = query_b021q05p01(concept_1, [industry_2], [location_1], year_1, year_2)', ""var_q5_p3 = sum(var_q5_p2, axis='columns', keep_col=false, level=null)"", ""var_q5_p4 = mean(var_q5_p3, axis='rows', keep_col=false, level=null, skipna=true)"", ""var_q5_p5 = sum(var_q5_p1, axis='columns', keep_col=false, level=null)"", ""var_q5_p6 = mean(var_q5_p5, axis='rows', keep_col=false, level=null, skipna=true)"", ""var_q5_p7 = merge(var_q5_p4, axis='rows', dfs=[var_q5_p6], ignore_index=True, replace_columns=True)"", ""var_q5_p8 = diff(var_q5_p7, axis='rows')"", 'var_q5_p9 = abs(var_q5_p8, )']",3640500,chat-3-01
3,multi-hop,4,6,Expand the locations to include Delaware and Massachusetts too. How much is the difference now?,"{'location_2': {'mention': 'Delaware', 'name': 'DELAWARE'}, 'location_3': {'mention': 'Massachusetts', 'name': 'MASSACHUSETTS'}, 'location_1': {'mention': 'New York', 'name': 'NEW YORK'}, 'num_2': 'two', 'industry_2': {'mention': 'real estate investment trusts', 'name': 'REAL ESTATE INVESTMENT TRUSTS'}, 'num_1': 'three', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'security deposits', 'name': 'us-gaap:SecurityDeposit'}, 'industry_1': {'mention': 'pharmaceutical preparations', 'name': 'PHARMACEUTICAL PREPARATIONS'}}","{'var_q6_p1': 'WITH [2020, 2021, 2022] AS years, [""PHARMACEUTICAL PREPARATIONS""] AS industries, [""NEW YORK"", ""DELAWARE"", ""MASSACHUSETTS""] AS locations MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry), (o)-[:HAS_STATE_LOCATION]->(s:State) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND s.name IN locations AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, s.name AS location, f.year AS year, f.number as value ORDER BY industry, company', 'var_q6_p2': 'WITH [2020, 2021, 2022] AS years, [""REAL ESTATE INVESTMENT TRUSTS""] AS industries, [""NEW YORK"", ""DELAWARE"", ""MASSACHUSETTS""] AS locations MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry), (o)-[:HAS_STATE_LOCATION]->(s:State) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND s.name IN locations AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, s.name AS location, f.year AS year, f.number as value ORDER BY industry, company'}","['var_q6_p1 = query_b021q05p01(concept_1, [industry_1], [location_1, location_2, location_3], year_1, year_2)', 'var_q6_p2 = query_b021q05p01(concept_1, [industry_2], [location_1, location_2, location_3], year_1, year_2)', ""var_q6_p3 = sum(var_q6_p2, axis='columns', keep_col=false, level=null)"", ""var_q6_p4 = mean(var_q6_p3, axis='rows', keep_col=false, level=null, skipna=true)"", ""var_q6_p5 = sum(var_q6_p1, axis='columns', keep_col=false, level=null)"", ""var_q6_p6 = mean(var_q6_p5, axis='rows', keep_col=false, level=null, skipna=true)"", ""var_q6_p7 = merge(var_q6_p4, axis='rows', dfs=[var_q6_p6], ignore_index=True, replace_columns=True)"", ""var_q6_p8 = diff(var_q6_p7, axis='rows')"", 'var_q6_p9 = abs(var_q6_p8, )']",162571.43,chat-3-01
3,multi-hop,4,7,"In addition to the locations, I want only those reporting security deposits at least one time(s) during the period. How much is the difference?","{'num_3': 'one', 'location_2': {'mention': 'Delaware', 'name': 'DELAWARE'}, 'location_3': {'mention': 'Massachusetts', 'name': 'MASSACHUSETTS'}, 'location_1': {'mention': 'New York', 'name': 'NEW YORK'}, 'num_2': 'two', 'industry_2': {'mention': 'real estate investment trusts', 'name': 'REAL ESTATE INVESTMENT TRUSTS'}, 'num_1': 'three', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'security deposits', 'name': 'us-gaap:SecurityDeposit'}, 'industry_1': {'mention': 'pharmaceutical preparations', 'name': 'PHARMACEUTICAL PREPARATIONS'}}","{'var_q7_p1': 'WITH [2020, 2021, 2022] AS years, [""PHARMACEUTICAL PREPARATIONS""] AS industries, [""NEW YORK"", ""DELAWARE"", ""MASSACHUSETTS""] AS locations MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry), (o)-[:HAS_STATE_LOCATION]->(s:State) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND s.name IN locations AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, s.name AS location, f.year AS year, f.number as value ORDER BY industry, company', 'var_q7_p2': 'WITH [2020, 2021, 2022] AS years, [""REAL ESTATE INVESTMENT TRUSTS""] AS industries, [""NEW YORK"", ""DELAWARE"", ""MASSACHUSETTS""] AS locations MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry), (o)-[:HAS_STATE_LOCATION]->(s:State) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND s.name IN locations AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, s.name AS location, f.year AS year, f.number as value ORDER BY industry, company'}","['var_q7_p1 = query_b021q05p01(concept_1, [industry_1], [location_1, location_2, location_3], year_1, year_2)', 'var_q7_p2 = query_b021q05p01(concept_1, [industry_2], [location_1, location_2, location_3], year_1, year_2)', ""var_q7_p3 = cond(var_q7_p2, cond_source='custom', cond_step=var_q7_p2, cond_val='0', condition='gt', target_source='custom', target_step=var_q7_p2, target_val='1')"", ""var_q7_p4 = sum(var_q7_p3, axis='columns', keep_col=false, level=null)"", ""var_q7_p5 = loc_filter(var_q7_p4, axis='rows', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q7_p4, val='1')"", ""var_q7_p6 = intersect(var_q7_p2, axis='rows', dfs=[var_q7_p5], level=null)"", ""var_q7_p7 = sum(var_q7_p6, axis='columns', keep_col=false, level=null)"", ""var_q7_p8 = mean(var_q7_p7, axis='rows', keep_col=false, level=null, skipna=true)"", ""var_q7_p9 = cond(var_q7_p1, cond_source='custom', cond_step=var_q7_p8, cond_val='0', condition='gt', target_source='custom', target_step=var_q7_p8, target_val='1')"", ""var_q7_p10 = sum(var_q7_p9, axis='columns', keep_col=false, level=null)"", ""var_q7_p11 = loc_filter(var_q7_p10, axis='rows', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q7_p10, val='1')"", ""var_q7_p12 = intersect(var_q7_p1, axis='rows', dfs=[var_q7_p11], level=null)"", ""var_q7_p13 = sum(var_q7_p12, axis='columns', keep_col=false, level=null)"", ""var_q7_p14 = mean(var_q7_p13, axis='rows', keep_col=false, level=null, skipna=true)"", ""var_q7_p15 = merge(var_q7_p8, axis='rows', dfs=[var_q7_p14], ignore_index=True, replace_columns=True)"", ""var_q7_p16 = diff(var_q7_p15, axis='rows')"", 'var_q7_p17 = abs(var_q7_p16, )']",162571.43,chat-3-01
3,multi-hop,4,8,How many companies are involved in this calculation?,"{'num_3': 'one', 'location_2': {'mention': 'Delaware', 'name': 'DELAWARE'}, 'location_3': {'mention': 'Massachusetts', 'name': 'MASSACHUSETTS'}, 'location_1': {'mention': 'New York', 'name': 'NEW YORK'}, 'num_2': 'two', 'industry_2': {'mention': 'real estate investment trusts', 'name': 'REAL ESTATE INVESTMENT TRUSTS'}, 'num_1': 'three', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'security deposits', 'name': 'us-gaap:SecurityDeposit'}, 'industry_1': {'mention': 'pharmaceutical preparations', 'name': 'PHARMACEUTICAL PREPARATIONS'}}","{'var_q8_p1': 'WITH [2020, 2021, 2022] AS years, [""PHARMACEUTICAL PREPARATIONS""] AS industries, [""NEW YORK"", ""DELAWARE"", ""MASSACHUSETTS""] AS locations MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry), (o)-[:HAS_STATE_LOCATION]->(s:State) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND s.name IN locations AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, s.name AS location, f.year AS year, f.number as value ORDER BY industry, company', 'var_q8_p2': 'WITH [2020, 2021, 2022] AS years, [""REAL ESTATE INVESTMENT TRUSTS""] AS industries, [""NEW YORK"", ""DELAWARE"", ""MASSACHUSETTS""] AS locations MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry), (o)-[:HAS_STATE_LOCATION]->(s:State) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND s.name IN locations AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, s.name AS location, f.year AS year, f.number as value ORDER BY industry, company'}","['var_q8_p1 = query_b021q05p01(concept_1, [industry_1], [location_1, location_2, location_3], year_1, year_2)', 'var_q8_p2 = query_b021q05p01(concept_1, [industry_2], [location_1, location_2, location_3], year_1, year_2)', ""var_q8_p3 = cond(var_q8_p2, cond_source='custom', cond_step=var_q8_p2, cond_val='0', condition='gt', target_source='custom', target_step=var_q8_p2, target_val='1')"", ""var_q8_p4 = sum(var_q8_p3, axis='columns', keep_col=false, level=null)"", ""var_q8_p5 = loc_filter(var_q8_p4, axis='rows', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q8_p4, val='1')"", ""var_q8_p6 = cond(var_q8_p1, cond_source='custom', cond_step=var_q8_p5, cond_val='0', condition='gt', target_source='custom', target_step=var_q8_p5, target_val='1')"", ""var_q8_p7 = sum(var_q8_p6, axis='columns', keep_col=false, level=null)"", ""var_q8_p8 = loc_filter(var_q8_p7, axis='rows', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q8_p7, val='1')"", ""var_q8_p9 = merge(var_q8_p8, axis='rows', dfs=[var_q8_p5], ignore_index=False, replace_columns=True)"", ""var_q8_p10 = headers(var_q8_p9, axis='rows', level=2)"", ""var_q8_p11 = count(var_q8_p10, axis='rows')""]",10,chat-3-01
3,multi-hop,4,9,Limit the scope further to those reporting at least two time(s). How many now?,"{'num_4': 'two', 'num_3': 'one', 'location_2': {'mention': 'Delaware', 'name': 'DELAWARE'}, 'location_3': {'mention': 'Massachusetts', 'name': 'MASSACHUSETTS'}, 'location_1': {'mention': 'New York', 'name': 'NEW YORK'}, 'num_2': 'two', 'industry_2': {'mention': 'real estate investment trusts', 'name': 'REAL ESTATE INVESTMENT TRUSTS'}, 'num_1': 'three', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'security deposits', 'name': 'us-gaap:SecurityDeposit'}, 'industry_1': {'mention': 'pharmaceutical preparations', 'name': 'PHARMACEUTICAL PREPARATIONS'}}","{'var_q9_p1': 'WITH [2020, 2021, 2022] AS years, [""PHARMACEUTICAL PREPARATIONS""] AS industries, [""NEW YORK"", ""DELAWARE"", ""MASSACHUSETTS""] AS locations MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry), (o)-[:HAS_STATE_LOCATION]->(s:State) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND s.name IN locations AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, s.name AS location, f.year AS year, f.number as value ORDER BY industry, company', 'var_q9_p2': 'WITH [2020, 2021, 2022] AS years, [""REAL ESTATE INVESTMENT TRUSTS""] AS industries, [""NEW YORK"", ""DELAWARE"", ""MASSACHUSETTS""] AS locations MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry), (o)-[:HAS_STATE_LOCATION]->(s:State) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND s.name IN locations AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, s.name AS location, f.year AS year, f.number as value ORDER BY industry, company'}","['var_q9_p1 = query_b021q05p01(concept_1, [industry_1], [location_1, location_2, location_3], year_1, year_2)', 'var_q9_p2 = query_b021q05p01(concept_1, [industry_2], [location_1, location_2, location_3], year_1, year_2)', ""var_q9_p3 = cond(var_q9_p2, cond_source='custom', cond_step=var_q9_p2, cond_val='0', condition='gt', target_source='custom', target_step=var_q9_p2, target_val='1')"", ""var_q9_p4 = sum(var_q9_p3, axis='columns', keep_col=false, level=null)"", ""var_q9_p5 = k_end(var_q9_p4, axis='rows', direction='first', k='2', reverse=false)"", ""var_q9_p6 = cond(var_q9_p1, cond_source='custom', cond_step=var_q9_p5, cond_val='0', condition='gt', target_source='custom', target_step=var_q9_p5, target_val='1')"", ""var_q9_p7 = sum(var_q9_p6, axis='columns', keep_col=false, level=null)"", ""var_q9_p8 = loc_filter(var_q9_p7, axis='rows', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q9_p7, val='2')"", ""var_q9_p9 = merge(var_q9_p8, axis='rows', dfs=[var_q9_p5], ignore_index=False, replace_columns=True)"", ""var_q9_p10 = headers(var_q9_p9, axis='rows', level=2)"", ""var_q9_p11 = count(var_q9_p10, axis='rows')""]",7,chat-3-01
3,multi-hop,4,10,And how much is the difference in the averages of combined security deposits?,"{'num_4': 'two', 'num_3': 'one', 'location_2': {'mention': 'Delaware', 'name': 'DELAWARE'}, 'location_3': {'mention': 'Massachusetts', 'name': 'MASSACHUSETTS'}, 'location_1': {'mention': 'New York', 'name': 'NEW YORK'}, 'num_2': 'two', 'industry_2': {'mention': 'real estate investment trusts', 'name': 'REAL ESTATE INVESTMENT TRUSTS'}, 'num_1': 'three', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'security deposits', 'name': 'us-gaap:SecurityDeposit'}, 'industry_1': {'mention': 'pharmaceutical preparations', 'name': 'PHARMACEUTICAL PREPARATIONS'}}","{'var_q10_p1': 'WITH [2020, 2021, 2022] AS years, [""PHARMACEUTICAL PREPARATIONS""] AS industries, [""NEW YORK"", ""DELAWARE"", ""MASSACHUSETTS""] AS locations MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry), (o)-[:HAS_STATE_LOCATION]->(s:State) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND s.name IN locations AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, s.name AS location, f.year AS year, f.number as value ORDER BY industry, company', 'var_q10_p2': 'WITH [2020, 2021, 2022] AS years, [""REAL ESTATE INVESTMENT TRUSTS""] AS industries, [""NEW YORK"", ""DELAWARE"", ""MASSACHUSETTS""] AS locations MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry), (o)-[:HAS_STATE_LOCATION]->(s:State) WHERE c.name = ""us-gaap:SecurityDeposit"" AND f.year in years AND i.name IN industries AND s.name IN locations AND f.number IS NOT NULL RETURN DISTINCT i.name AS industry, o.name AS company, c.name AS concept, s.name AS location, f.year AS year, f.number as value ORDER BY industry, company'}","['var_q10_p1 = query_b021q05p01(concept_1, [industry_1], [location_1, location_2, location_3], year_1, year_2)', 'var_q10_p2 = query_b021q05p01(concept_1, [industry_2], [location_1, location_2, location_3], year_1, year_2)', ""var_q10_p3 = cond(var_q10_p2, cond_source='custom', cond_step=var_q10_p2, cond_val='0', condition='gt', target_source='custom', target_step=var_q10_p2, target_val='1')"", ""var_q10_p4 = sum(var_q10_p3, axis='columns', keep_col=false, level=null)"", ""var_q10_p5 = loc_filter(var_q10_p4, axis='rows', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q10_p4, val='2')"", ""var_q10_p6 = intersect(var_q10_p2, axis='rows', dfs=[var_q10_p5], level=null)"", ""var_q10_p7 = sum(var_q10_p6, axis='columns', keep_col=false, level=null)"", ""var_q10_p8 = mean(var_q10_p7, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q10_p9 = cond(var_q10_p1, cond_source='custom', cond_step=var_q10_p8, cond_val='0', condition='gt', target_source='custom', target_step=var_q10_p8, target_val='1')"", ""var_q10_p10 = sum(var_q10_p9, axis='columns', keep_col=false, level=null)"", ""var_q10_p11 = loc_filter(var_q10_p10, axis='rows', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q10_p10, val='2')"", ""var_q10_p12 = intersect(var_q10_p1, axis='rows', dfs=[var_q10_p11], level=null)"", ""var_q10_p13 = sum(var_q10_p12, axis='columns', keep_col=false, level=null)"", ""var_q10_p14 = mean(var_q10_p13, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q10_p15 = merge(var_q10_p8, axis='rows', dfs=[var_q10_p14], ignore_index=True, replace_columns=True)"", ""var_q10_p16 = diff(var_q10_p15, axis='rows')"", 'var_q10_p17 = abs(var_q10_p16, )']",1357800,chat-3-01
4,multi-table,5,1,"During the three-year period starting 2020, which year had the most companies reporting long-term debt maturities over 1B?","{'num_1': 'three', 'num_2': '1B', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'long-term debt maturities', 'name': 'us-gaap:LongTermDebtAndCapitalLeaseObligations'}}","{'var_q1_p1': 'WITH [""us-gaap:LongTermDebtAndCapitalLeaseObligations""] AS concepts, [2020, 2021, 2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q1_p1 = filter_companies_by_facts(None, concept_1, start=year_1, end=year_2)', ""var_q1_p2 = cond(var_q1_p1, cond_source='custom', cond_step=var_q1_p1, cond_val='1b', condition='le', target_source='custom', target_step=var_q1_p1, target_val='0')"", ""var_q1_p3 = cond(var_q1_p2, cond_source='custom', cond_step=var_q1_p2, cond_val='1b', condition='gt', target_source='custom', target_step=var_q1_p2, target_val='1')"", ""var_q1_p4 = sum(var_q1_p3, axis='rows', keep_col=false, level=null)"", ""var_q1_p5 = sort(var_q1_p4, ascending=False, axis='rows', by=[null])"", ""var_q1_p6 = k_end(var_q1_p5, axis='rows', direction='first', k='1', reverse=false)"", ""var_q1_p7 = headers(var_q1_p6, axis='rows', level=null)""]",2020,chat-4-01
4,multi-table,5,2,Remove companies that reported long-term debt maturities below 500M any year during the period. Which year?,"{'num_3': '500M', 'num_1': 'three', 'num_2': '1B', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'long-term debt maturities', 'name': 'us-gaap:LongTermDebtAndCapitalLeaseObligations'}}","{'var_q2_p1': 'WITH [""us-gaap:LongTermDebtAndCapitalLeaseObligations""] AS concepts, [2020, 2021, 2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q2_p1 = filter_companies_by_facts(None, concept_1, start=year_1, end=year_2)', ""var_q2_p2 = cond(var_q2_p1, cond_source='custom', cond_step=var_q2_p1, cond_val='500m', condition='lt', target_source='custom', target_step=var_q2_p1, target_val='1')"", ""var_q2_p3 = cond(var_q2_p2, cond_source='custom', cond_step=var_q2_p2, cond_val='500m', condition='ge', target_source='custom', target_step=var_q2_p2, target_val='0')"", ""var_q2_p4 = sum(var_q2_p3, axis='columns', keep_col=false, level=null)"", ""var_q2_p5 = loc_filter(var_q2_p4, axis='rows', columns=':', condition='equal', idx=':', operation='all', source='custom', step=var_q2_p4, val='0')"", ""var_q2_p6 = intersect(var_q2_p1, axis='rows', dfs=[var_q2_p5], level=0)"", ""var_q2_p7 = cond(var_q2_p6, cond_source='custom', cond_step=var_q2_p6, cond_val='1b', condition='le', target_source='custom', target_step=var_q2_p6, target_val='0')"", ""var_q2_p8 = cond(var_q2_p7, cond_source='custom', cond_step=var_q2_p7, cond_val='1b', condition='gt', target_source='custom', target_step=var_q2_p7, target_val='1')"", ""var_q2_p9 = sum(var_q2_p8, axis='rows', keep_col=false, level=null)"", ""var_q2_p10 = sort(var_q2_p9, ascending=False, axis='rows', by=[null])"", ""var_q2_p11 = k_end(var_q2_p10, axis='rows', direction='first', k='1', reverse=false)"", ""var_q2_p12 = headers(var_q2_p11, axis='rows', level=null)""]",2020,chat-4-01
4,multi-table,5,3,"Repeat the same calculation (without removing companies) on net cash provided by (used in) investing activities with a threshold of 300M. Is it the same year as long-term debt maturities, yes or no?","{'num_4': '300M', 'concept_2': {'mention': 'net cash provided by (used in) investing activities', 'name': 'us-gaap:NetCashProvidedByUsedInInvestingActivities'}, 'num_3': '500M', 'num_1': 'three', 'num_2': '1B', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'long-term debt maturities', 'name': 'us-gaap:LongTermDebtAndCapitalLeaseObligations'}}","{'var_q3_p1': 'WITH [""us-gaap:LongTermDebtAndCapitalLeaseObligations""] AS concepts, [2020, 2021, 2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q3_p2': 'WITH [""us-gaap:NetCashProvidedByUsedInInvestingActivities""] AS concepts, [2020, 2021, 2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q3_p1 = filter_companies_by_facts(None, concept_1, start=year_1, end=year_2)', 'var_q3_p2 = filter_companies_by_facts(None, concept_2, start=year_1, end=year_2)', ""var_q3_p3 = cond(var_q3_p2, cond_source='custom', cond_step=var_q3_p2, cond_val='300m', condition='le', target_source='custom', target_step=var_q3_p2, target_val='0')"", ""var_q3_p4 = cond(var_q3_p3, cond_source='custom', cond_step=var_q3_p3, cond_val='300m', condition='gt', target_source='custom', target_step=var_q3_p3, target_val='1')"", ""var_q3_p5 = sum(var_q3_p4, axis='rows', keep_col=false, level=null)"", ""var_q3_p6 = sort(var_q3_p5, ascending=False, axis='rows', by=[null])"", ""var_q3_p7 = k_end(var_q3_p6, axis='rows', direction='first', k='1', reverse=false)"", ""var_q3_p8 = headers(var_q3_p7, axis='rows', level=null)"", ""var_q3_p9 = cond(var_q3_p1, cond_source='custom', cond_step=var_q3_p8, cond_val='1b', condition='le', target_source='custom', target_step=var_q3_p8, target_val='0')"", ""var_q3_p10 = cond(var_q3_p9, cond_source='custom', cond_step=var_q3_p9, cond_val='1b', condition='gt', target_source='custom', target_step=var_q3_p9, target_val='1')"", ""var_q3_p11 = sum(var_q3_p10, axis='rows', keep_col=false, level=null)"", ""var_q3_p12 = sort(var_q3_p11, ascending=False, axis='rows', by=[null])"", ""var_q3_p13 = k_end(var_q3_p12, axis='rows', direction='first', k='1', reverse=false)"", ""var_q3_p14 = headers(var_q3_p13, axis='rows', level=null)"", ""var_q3_p15 = choices(var_q3_p14, choice='no')""]",no,chat-4-01
4,multi-table,5,4,Maintain the removal rule on the long-term debt maturities and apply another rule on the net cash provided by (used in) investing activities with a threshold of 1.5B. How much different is the 2020-2022 average long-term debt maturities to the 2019-2021 average net cash provided by (used in) investing activities?,"{'num_5': '1.5B', 'year_3': 2019, 'year_4': 2021, 'num_4': '300M', 'concept_2': {'mention': 'net cash provided by (used in) investing activities', 'name': 'us-gaap:NetCashProvidedByUsedInInvestingActivities'}, 'num_3': '500M', 'num_1': 'three', 'num_2': '1B', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'long-term debt maturities', 'name': 'us-gaap:LongTermDebtAndCapitalLeaseObligations'}}","{'var_q4_p1': 'WITH [""us-gaap:LongTermDebtAndCapitalLeaseObligations""] AS concepts, [2020, 2021, 2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q4_p2': 'WITH [""us-gaap:NetCashProvidedByUsedInInvestingActivities""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q4_p1 = filter_companies_by_facts(None, concept_1, start=year_1, end=year_2)', 'var_q4_p2 = filter_companies_by_facts(None, concept_2, start=year_3, end=year_4)', ""var_q4_p3 = cond(var_q4_p2, cond_source='custom', cond_step=var_q4_p2, cond_val='1.5b', condition='lt', target_source='custom', target_step=var_q4_p2, target_val='1')"", ""var_q4_p4 = cond(var_q4_p3, cond_source='custom', cond_step=var_q4_p3, cond_val='1.5b', condition='ge', target_source='custom', target_step=var_q4_p3, target_val='0')"", ""var_q4_p5 = sum(var_q4_p4, axis='columns', keep_col=false, level=null)"", ""var_q4_p6 = loc_filter(var_q4_p5, axis='rows', columns=':', condition='equal', idx=':', operation='all', source='custom', step=var_q4_p5, val='0')"", ""var_q4_p7 = intersect(var_q4_p2, axis='rows', dfs=[var_q4_p6], level=0)"", ""var_q4_p8 = mean(var_q4_p7, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q4_p9 = mean(var_q4_p8, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q4_p10 = cond(var_q4_p1, cond_source='custom', cond_step=var_q4_p9, cond_val='500m', condition='lt', target_source='custom', target_step=var_q4_p9, target_val='1')"", ""var_q4_p11 = cond(var_q4_p10, cond_source='custom', cond_step=var_q4_p10, cond_val='500m', condition='ge', target_source='custom', target_step=var_q4_p10, target_val='0')"", ""var_q4_p12 = sum(var_q4_p11, axis='columns', keep_col=false, level=null)"", ""var_q4_p13 = loc_filter(var_q4_p12, axis='rows', columns=':', condition='equal', idx=':', operation='all', source='custom', step=var_q4_p12, val='0')"", ""var_q4_p14 = intersect(var_q4_p1, axis='rows', dfs=[var_q4_p13], level=0)"", ""var_q4_p15 = mean(var_q4_p14, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q4_p16 = mean(var_q4_p15, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q4_p17 = merge(var_q4_p16, axis='rows', dfs=[var_q4_p9], ignore_index=True, replace_columns=True)"", ""var_q4_p18 = diff(var_q4_p17, axis='rows')"", 'var_q4_p19 = abs(var_q4_p18, )']",2280000820.48,chat-4-01
4,multi-table,5,5,"If we doubled all long-term debt maturities below 300M and all net cash provided by (used in) investing activities below 1.2B before removing companies, how much would the difference be?","{'num_6': '300M', 'num_7': '1.2B', 'num_5': '1.5B', 'year_3': 2019, 'year_4': 2021, 'num_4': '300M', 'concept_2': {'mention': 'net cash provided by (used in) investing activities', 'name': 'us-gaap:NetCashProvidedByUsedInInvestingActivities'}, 'num_3': '500M', 'num_1': 'three', 'num_2': '1B', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'long-term debt maturities', 'name': 'us-gaap:LongTermDebtAndCapitalLeaseObligations'}}","{'var_q5_p1': 'WITH [""us-gaap:LongTermDebtAndCapitalLeaseObligations""] AS concepts, [2020, 2021, 2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q5_p2': 'WITH [""us-gaap:NetCashProvidedByUsedInInvestingActivities""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q5_p1 = filter_companies_by_facts(None, concept_1, start=year_1, end=year_2)', 'var_q5_p2 = filter_companies_by_facts(None, concept_2, start=year_3, end=year_4)', ""var_q5_p3 = cond(var_q5_p2, cond_source='custom', cond_step=var_q5_p2, cond_val='1.2b', condition='ge', target_source='custom', target_step=var_q5_p2, target_val='0')"", ""var_q5_p4 = const_mul(var_q5_p3, columns=':', idx=':', source='custom', step=var_q5_p3, val='2')"", ""var_q5_p5 = cond(var_q5_p2, cond_source='custom', cond_step=var_q5_p4, cond_val='1.2b', condition='lt', target_source='custom', target_step=var_q5_p4, target_val='0')"", ""var_q5_p6 = const_add(var_q5_p5, columns=':', idx=':', source='table', step=var_q5_p5, table=var_q5_p4, val='1m')"", ""var_q5_p7 = loc_filter(var_q5_p6, axis='columns', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q5_p6, val='1.5b')"", ""var_q5_p8 = mean(var_q5_p7, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q5_p9 = mean(var_q5_p8, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q5_p10 = cond(var_q5_p1, cond_source='custom', cond_step=var_q5_p9, cond_val='300m', condition='ge', target_source='custom', target_step=var_q5_p9, target_val='0')"", ""var_q5_p11 = const_mul(var_q5_p10, columns=':', idx=':', source='custom', step=var_q5_p10, val='2')"", ""var_q5_p12 = cond(var_q5_p1, cond_source='custom', cond_step=var_q5_p11, cond_val='300m', condition='lt', target_source='custom', target_step=var_q5_p11, target_val='0')"", ""var_q5_p13 = const_add(var_q5_p12, columns=':', idx=':', source='table', step=var_q5_p12, table=var_q5_p11, val='1m')"", ""var_q5_p14 = loc_filter(var_q5_p13, axis='columns', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q5_p13, val='500m')"", ""var_q5_p15 = mean(var_q5_p14, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q5_p16 = mean(var_q5_p15, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q5_p17 = merge(var_q5_p16, axis='rows', dfs=[var_q5_p9], ignore_index=True, replace_columns=True)"", ""var_q5_p18 = diff(var_q5_p17, axis='rows')"", 'var_q5_p19 = abs(var_q5_p18, )']",3871508755.67,chat-4-01
4,multi-table,5,6,"With the adjusted values, how many companies were removed from both lists?","{'num_6': '300M', 'num_7': '1.2B', 'num_5': '1.5B', 'year_3': 2019, 'year_4': 2021, 'num_4': '300M', 'concept_2': {'mention': 'net cash provided by (used in) investing activities', 'name': 'us-gaap:NetCashProvidedByUsedInInvestingActivities'}, 'num_3': '500M', 'num_1': 'three', 'num_2': '1B', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'long-term debt maturities', 'name': 'us-gaap:LongTermDebtAndCapitalLeaseObligations'}}","{'var_q6_p1': 'WITH [""us-gaap:LongTermDebtAndCapitalLeaseObligations""] AS concepts, [2020, 2021, 2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q6_p2': 'WITH [""us-gaap:NetCashProvidedByUsedInInvestingActivities""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q6_p1 = filter_companies_by_facts(None, concept_1, start=year_1, end=year_2)', 'var_q6_p2 = filter_companies_by_facts(None, concept_2, start=year_3, end=year_4)', ""var_q6_p3 = cond(var_q6_p2, cond_source='custom', cond_step=var_q6_p2, cond_val='1.2b', condition='ge', target_source='custom', target_step=var_q6_p2, target_val='0')"", ""var_q6_p4 = const_mul(var_q6_p3, columns=':', idx=':', source='custom', step=var_q6_p3, val='2')"", ""var_q6_p5 = cond(var_q6_p2, cond_source='custom', cond_step=var_q6_p4, cond_val='1.2b', condition='lt', target_source='custom', target_step=var_q6_p4, target_val='0')"", ""var_q6_p6 = const_add(var_q6_p5, columns=':', idx=':', source='table', step=var_q6_p5, table=var_q6_p4, val='1m')"", ""var_q6_p7 = loc_filter(var_q6_p6, axis='columns', columns=':', condition='lt', idx=':', operation='any', source='custom', step=var_q6_p6, val='1.5b')"", ""var_q6_p8 = cond(var_q6_p1, cond_source='custom', cond_step=var_q6_p7, cond_val='300m', condition='ge', target_source='custom', target_step=var_q6_p7, target_val='0')"", ""var_q6_p9 = const_mul(var_q6_p8, columns=':', idx=':', source='custom', step=var_q6_p8, val='2')"", ""var_q6_p10 = cond(var_q6_p1, cond_source='custom', cond_step=var_q6_p9, cond_val='300m', condition='lt', target_source='custom', target_step=var_q6_p9, target_val='0')"", ""var_q6_p11 = const_add(var_q6_p10, columns=':', idx=':', source='table', step=var_q6_p10, table=var_q6_p9, val='1m')"", ""var_q6_p12 = loc_filter(var_q6_p11, axis='columns', columns=':', condition='lt', idx=':', operation='any', source='custom', step=var_q6_p11, val='500m')"", ""var_q6_p13 = intersect(var_q6_p12, axis='rows', dfs=[var_q6_p7], level=0)"", ""var_q6_p14 = count(var_q6_p13, axis='columns')""]",83,chat-4-01
4,multi-table,5,7,"If we did not remove these companies, with the adjusted values, how much would the difference be?","{'num_6': '300M', 'num_7': '1.2B', 'num_5': '1.5B', 'year_3': 2019, 'year_4': 2021, 'num_4': '300M', 'concept_2': {'mention': 'net cash provided by (used in) investing activities', 'name': 'us-gaap:NetCashProvidedByUsedInInvestingActivities'}, 'num_3': '500M', 'num_1': 'three', 'num_2': '1B', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'long-term debt maturities', 'name': 'us-gaap:LongTermDebtAndCapitalLeaseObligations'}}","{'var_q7_p1': 'WITH [""us-gaap:LongTermDebtAndCapitalLeaseObligations""] AS concepts, [2020, 2021, 2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q7_p2': 'WITH [""us-gaap:NetCashProvidedByUsedInInvestingActivities""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q7_p1 = filter_companies_by_facts(None, concept_1, start=year_1, end=year_2)', 'var_q7_p2 = filter_companies_by_facts(None, concept_2, start=year_3, end=year_4)', ""var_q7_p3 = cond(var_q7_p2, cond_source='custom', cond_step=var_q7_p2, cond_val='1.2b', condition='ge', target_source='custom', target_step=var_q7_p2, target_val='0')"", ""var_q7_p4 = const_mul(var_q7_p3, columns=':', idx=':', source='custom', step=var_q7_p3, val='2')"", ""var_q7_p5 = cond(var_q7_p2, cond_source='custom', cond_step=var_q7_p4, cond_val='1.2b', condition='lt', target_source='custom', target_step=var_q7_p4, target_val='0')"", ""var_q7_p6 = const_add(var_q7_p5, columns=':', idx=':', source='table', step=var_q7_p5, table=var_q7_p4, val='1m')"", ""var_q7_p7 = mean(var_q7_p6, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q7_p8 = mean(var_q7_p7, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q7_p9 = cond(var_q7_p1, cond_source='custom', cond_step=var_q7_p8, cond_val='300m', condition='ge', target_source='custom', target_step=var_q7_p8, target_val='0')"", ""var_q7_p10 = const_mul(var_q7_p9, columns=':', idx=':', source='custom', step=var_q7_p9, val='2')"", ""var_q7_p11 = cond(var_q7_p1, cond_source='custom', cond_step=var_q7_p10, cond_val='300m', condition='lt', target_source='custom', target_step=var_q7_p10, target_val='0')"", ""var_q7_p12 = const_add(var_q7_p11, columns=':', idx=':', source='table', step=var_q7_p11, table=var_q7_p10, val='1m')"", ""var_q7_p13 = mean(var_q7_p12, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q7_p14 = mean(var_q7_p13, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q7_p15 = merge(var_q7_p14, axis='rows', dfs=[var_q7_p8], ignore_index=True, replace_columns=True)"", ""var_q7_p16 = diff(var_q7_p15, axis='rows')"", 'var_q7_p17 = abs(var_q7_p16, )']",5574044128.87,chat-4-01
4,multi-table,5,8,What about the difference of just the top ten companies by their adjusted averages during the period?,"{'num_8': 'ten', 'num_6': '300M', 'num_7': '1.2B', 'num_5': '1.5B', 'year_3': 2019, 'year_4': 2021, 'num_4': '300M', 'concept_2': {'mention': 'net cash provided by (used in) investing activities', 'name': 'us-gaap:NetCashProvidedByUsedInInvestingActivities'}, 'num_3': '500M', 'num_1': 'three', 'num_2': '1B', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'long-term debt maturities', 'name': 'us-gaap:LongTermDebtAndCapitalLeaseObligations'}}","{'var_q8_p1': 'WITH [""us-gaap:LongTermDebtAndCapitalLeaseObligations""] AS concepts, [2020, 2021, 2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q8_p2': 'WITH [""us-gaap:NetCashProvidedByUsedInInvestingActivities""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q8_p1 = filter_companies_by_facts(None, concept_1, start=year_1, end=year_2)', 'var_q8_p2 = filter_companies_by_facts(None, concept_2, start=year_3, end=year_4)', ""var_q8_p3 = cond(var_q8_p2, cond_source='custom', cond_step=var_q8_p2, cond_val='1.2b', condition='ge', target_source='custom', target_step=var_q8_p2, target_val='0')"", ""var_q8_p4 = const_mul(var_q8_p3, columns=':', idx=':', source='custom', step=var_q8_p3, val='2')"", ""var_q8_p5 = cond(var_q8_p2, cond_source='custom', cond_step=var_q8_p4, cond_val='1.2b', condition='lt', target_source='custom', target_step=var_q8_p4, target_val='0')"", ""var_q8_p6 = const_add(var_q8_p5, columns=':', idx=':', source='table', step=var_q8_p5, table=var_q8_p4, val='1m')"", ""var_q8_p7 = mean(var_q8_p6, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q8_p8 = sort(var_q8_p7, ascending=False, axis='rows', by=[null])"", ""var_q8_p9 = k_end(var_q8_p8, axis='rows', direction='first', k='10', reverse=false)"", ""var_q8_p10 = mean(var_q8_p9, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q8_p11 = cond(var_q8_p1, cond_source='custom', cond_step=var_q8_p10, cond_val='300m', condition='ge', target_source='custom', target_step=var_q8_p10, target_val='0')"", ""var_q8_p12 = const_mul(var_q8_p11, columns=':', idx=':', source='custom', step=var_q8_p11, val='2')"", ""var_q8_p13 = cond(var_q8_p1, cond_source='custom', cond_step=var_q8_p12, cond_val='300m', condition='lt', target_source='custom', target_step=var_q8_p12, target_val='0')"", ""var_q8_p14 = const_add(var_q8_p13, columns=':', idx=':', source='table', step=var_q8_p13, table=var_q8_p12, val='1m')"", ""var_q8_p15 = mean(var_q8_p14, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q8_p16 = sort(var_q8_p15, ascending=False, axis='rows', by=[null])"", ""var_q8_p17 = k_end(var_q8_p16, axis='rows', direction='first', k='10', reverse=false)"", ""var_q8_p18 = mean(var_q8_p17, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q8_p19 = merge(var_q8_p18, axis='rows', dfs=[var_q8_p10], ignore_index=True, replace_columns=True)"", ""var_q8_p20 = diff(var_q8_p19, axis='rows')"", 'var_q8_p21 = abs(var_q8_p20, )']",6477550000,chat-4-01
4,multi-table,5,9,"With no removal, what are the top ten companies by the adjusted average long-term debt maturities?","{'num_8': 'ten', 'num_6': '300M', 'num_7': '1.2B', 'num_5': '1.5B', 'year_3': 2019, 'year_4': 2021, 'num_4': '300M', 'concept_2': {'mention': 'net cash provided by (used in) investing activities', 'name': 'us-gaap:NetCashProvidedByUsedInInvestingActivities'}, 'num_3': '500M', 'num_1': 'three', 'num_2': '1B', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'long-term debt maturities', 'name': 'us-gaap:LongTermDebtAndCapitalLeaseObligations'}}","{'var_q9_p1': 'WITH [""us-gaap:LongTermDebtAndCapitalLeaseObligations""] AS concepts, [2020, 2021, 2022] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q9_p1 = filter_companies_by_facts(None, concept_1, start=year_1, end=year_2)', ""var_q9_p2 = cond(var_q9_p1, cond_source='custom', cond_step=var_q9_p1, cond_val='300m', condition='ge', target_source='custom', target_step=var_q9_p1, target_val='0')"", ""var_q9_p3 = const_mul(var_q9_p2, columns=':', idx=':', source='custom', step=var_q9_p2, val='2')"", ""var_q9_p4 = cond(var_q9_p1, cond_source='custom', cond_step=var_q9_p3, cond_val='300m', condition='lt', target_source='custom', target_step=var_q9_p3, target_val='0')"", ""var_q9_p5 = const_add(var_q9_p4, columns=':', idx=':', source='table', step=var_q9_p4, table=var_q9_p3, val='1m')"", ""var_q9_p6 = mean(var_q9_p5, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q9_p7 = sort(var_q9_p6, ascending=False, axis='rows', by=[null])"", ""var_q9_p8 = k_end(var_q9_p7, axis='rows', direction='first', k='10', reverse=false)"", ""var_q9_p9 = headers(var_q9_p8, axis='rows', level=0)""]","['CVS HEALTH Corp', 'BOEING CO', 'COMCAST CORP', 'SOUTHERN CO', 'VERIZON COMMUNICATIONS INC', 'Duke Energy Ohio, Inc.', 'AT&T INC.', 'Duke Energy CORP', 'AbbVie Inc.', 'DUKE ENERGY PROGRESS, LLC.']",chat-4-01
4,multi-table,5,10,And for net cash provided by (used in) investing activities?,"{'num_8': 'ten', 'num_6': '300M', 'num_7': '1.2B', 'num_5': '1.5B', 'year_3': 2019, 'year_4': 2021, 'num_4': '300M', 'concept_2': {'mention': 'net cash provided by (used in) investing activities', 'name': 'us-gaap:NetCashProvidedByUsedInInvestingActivities'}, 'num_3': '500M', 'num_1': 'three', 'num_2': '1B', 'year_1': 2020, 'year_2': 2022, 'concept_1': {'mention': 'long-term debt maturities', 'name': 'us-gaap:LongTermDebtAndCapitalLeaseObligations'}}","{'var_q10_p1': 'WITH [""us-gaap:NetCashProvidedByUsedInInvestingActivities""] AS concepts, [2019, 2020, 2021] AS years MATCH (o:Company)-[r:HAS_CONCEPT]-> (c:Concept)-[rf:HAS_FACT]->(f:Fact) WHERE c.name IN concepts AND f.year IN years AND f.number IS NOT NULL RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q10_p1 = filter_companies_by_facts(None, concept_2, start=year_3, end=year_4)', ""var_q10_p2 = cond(var_q10_p1, cond_source='custom', cond_step=var_q10_p1, cond_val='1.2b', condition='ge', target_source='custom', target_step=var_q10_p1, target_val='0')"", ""var_q10_p3 = const_mul(var_q10_p2, columns=':', idx=':', source='custom', step=var_q10_p2, val='2')"", ""var_q10_p4 = cond(var_q10_p1, cond_source='custom', cond_step=var_q10_p3, cond_val='1.2b', condition='lt', target_source='custom', target_step=var_q10_p3, target_val='0')"", ""var_q10_p5 = const_add(var_q10_p4, columns=':', idx=':', source='table', step=var_q10_p4, table=var_q10_p3, val='1m')"", ""var_q10_p6 = mean(var_q10_p5, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q10_p7 = sort(var_q10_p6, ascending=False, axis='rows', by=[null])"", ""var_q10_p8 = k_end(var_q10_p7, axis='rows', direction='first', k='10', reverse=false)"", ""var_q10_p9 = headers(var_q10_p8, axis='rows', level=0)""]","['SVB FINANCIAL GROUP', 'CITIGROUP INC', 'AMAZON COM INC', 'GOLDMAN SACHS GROUP INC', 'JPMORGAN CHASE & CO', 'VERIZON COMMUNICATIONS INC', 'Alphabet Inc.', 'BANK OF AMERICA CORP /DE/', 'SCHWAB CHARLES CORP', 'MORGAN STANLEY']",chat-4-01
5,instruction,6,1,"Suppose all companies in the services-packaged software industry reported estimated revenue expected to be recognized in the future for backlog related performance obligations 20% higher than they actually did from 2018 to 2021, and any companies with average current other accrued liabilities (after adjustment) during the period above 200M should be excluded from the analysis. What are the top and bottom five companies by combined estimated revenue expected to be recognized in the future for backlog related performance obligations during the period? (merge them togher into one list)","{'num_1': 20, 'num_2': '200M', 'num_3': 'five', 'year_1': 2018, 'year_2': 2021, 'industry_1': {'mention': 'services-packaged software', 'name': 'SERVICES-PREPACKAGED SOFTWARE'}, 'concept_1': {'mention': 'estimated revenue expected to be recognized in the future for backlog related performance obligations', 'name': 'us-gaap:RevenueRemainingPerformanceObligation'}, 'concept_2': {'mention': 'current other accrued liabilities', 'name': 'us-gaap:OtherAccruedLiabilitiesCurrent'}}","{'var_q1_p1': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:RevenueRemainingPerformanceObligation"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q1_p2': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:OtherAccruedLiabilitiesCurrent"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q1_p1 = query_b044q01p01_p02(concept_1, industry_1, start=year_1, end=year_2)', 'var_q1_p2 = query_b044q01p01_p02(concept_2, industry_1, start=year_1, end=year_2)', ""var_q1_p3 = const_mul(var_q1_p1, columns=':', idx=':', source='custom', step=var_q1_p2, val='1.2')"", ""var_q1_p4 = mean(var_q1_p2, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q1_p5 = loc_filter(var_q1_p4, axis='rows', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q1_p4, val='200m')"", ""var_q1_p6 = intersect(var_q1_p3, axis='rows', dfs=[var_q1_p5], level=0)"", ""var_q1_p7 = sum(var_q1_p6, axis='columns', keep_col=false, level=null)"", ""var_q1_p8 = sort(var_q1_p7, ascending=False, axis='rows', by=[null])"", ""var_q1_p9 = k_end(var_q1_p8, axis='columns', direction='first', k='5', reverse=false)"", ""var_q1_p10 = k_end(var_q1_p8, axis='columns', direction='last', k='5', reverse=false)"", ""var_q1_p11 = merge(var_q1_p10, axis='rows', dfs=[var_q1_p9], ignore_index=False, replace_columns=True)"", ""var_q1_p12 = headers(var_q1_p11, axis='rows', level=0)""]","['Asana, Inc.', 'Paylocity Holding Corp', 'CADENCE DESIGN SYSTEMS INC', 'AVID TECHNOLOGY, INC.', 'Autodesk, Inc.', 'NATIONAL INSTRUMENTS CORP', 'ServiceNow, Inc.', 'JFrog Ltd', 'Nuance Communications, Inc.', 'SYNOPSYS INC']",chat-5-01
5,instruction,6,2,How much different between the four-year averages of the combined estimated revenue expected to be recognized in the future for backlog related performance obligations of the top and bottom five?,"{'num_4': 'four', 'num_1': 20, 'num_2': '200M', 'num_3': 'five', 'year_1': 2018, 'year_2': 2021, 'industry_1': {'mention': 'services-packaged software', 'name': 'SERVICES-PREPACKAGED SOFTWARE'}, 'concept_1': {'mention': 'estimated revenue expected to be recognized in the future for backlog related performance obligations', 'name': 'us-gaap:RevenueRemainingPerformanceObligation'}, 'concept_2': {'mention': 'current other accrued liabilities', 'name': 'us-gaap:OtherAccruedLiabilitiesCurrent'}}","{'var_q2_p1': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:RevenueRemainingPerformanceObligation"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q2_p2': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:OtherAccruedLiabilitiesCurrent"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q2_p1 = query_b044q01p01_p02(concept_1, industry_1, start=year_1, end=year_2)', 'var_q2_p2 = query_b044q01p01_p02(concept_2, industry_1, start=year_1, end=year_2)', ""var_q2_p3 = const_mul(var_q2_p1, columns=':', idx=':', source='custom', step=var_q2_p2, val='1.2')"", ""var_q2_p4 = mean(var_q2_p2, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q2_p5 = loc_filter(var_q2_p4, axis='rows', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q2_p4, val='200m')"", ""var_q2_p6 = intersect(var_q2_p3, axis='rows', dfs=[var_q2_p5], level=0)"", ""var_q2_p7 = sum(var_q2_p6, axis='columns', keep_col=false, level=null)"", ""var_q2_p8 = sort(var_q2_p7, ascending=False, axis='rows', by=[null])"", ""var_q2_p9 = k_end(var_q2_p8, axis='columns', direction='first', k='5', reverse=false)"", ""var_q2_p10 = k_end(var_q2_p8, axis='columns', direction='last', k='5', reverse=false)"", ""var_q2_p11 = mean(var_q2_p9, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q2_p12 = mean(var_q2_p10, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q2_p13 = merge(var_q2_p12, axis='rows', dfs=[var_q2_p11], ignore_index=True, replace_columns=True)"", ""var_q2_p14 = diff(var_q2_p13, axis='rows')"", 'var_q2_p15 = abs(var_q2_p14, )']",1352212714800,chat-5-01
5,instruction,6,3,"Apply the 20% increase to current other accrued liabilities as well, what is the average of the combined estimated revenue expected to be recognized in the future for backlog related performance obligations of the top five?","{'num_4': 'four', 'num_1': 20, 'num_2': '200M', 'num_3': 'five', 'year_1': 2018, 'year_2': 2021, 'industry_1': {'mention': 'services-packaged software', 'name': 'SERVICES-PREPACKAGED SOFTWARE'}, 'concept_1': {'mention': 'estimated revenue expected to be recognized in the future for backlog related performance obligations', 'name': 'us-gaap:RevenueRemainingPerformanceObligation'}, 'concept_2': {'mention': 'current other accrued liabilities', 'name': 'us-gaap:OtherAccruedLiabilitiesCurrent'}}","{'var_q3_p1': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:RevenueRemainingPerformanceObligation"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q3_p2': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:OtherAccruedLiabilitiesCurrent"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q3_p1 = query_b044q01p01_p02(concept_1, industry_1, start=year_1, end=year_2)', 'var_q3_p2 = query_b044q01p01_p02(concept_2, industry_1, start=year_1, end=year_2)', ""var_q3_p3 = const_mul(var_q3_p1, columns=':', idx=':', source='custom', step=var_q3_p2, val='1.2')"", ""var_q3_p4 = const_mul(var_q3_p2, columns=':', idx=':', source='custom', step=var_q3_p3, val='1.2')"", ""var_q3_p5 = mean(var_q3_p4, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q3_p6 = loc_filter(var_q3_p5, axis='rows', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q3_p5, val='200m')"", ""var_q3_p7 = intersect(var_q3_p3, axis='rows', dfs=[var_q3_p6], level=0)"", ""var_q3_p8 = sum(var_q3_p7, axis='columns', keep_col=false, level=null)"", ""var_q3_p9 = sort(var_q3_p8, ascending=False, axis='rows', by=[])"", ""var_q3_p10 = k_end(var_q3_p9, axis='rows', direction='first', k='5', reverse=false)"", ""var_q3_p11 = mean(var_q3_p10, axis='columns', keep_col=false, level=null, skipna=true)""]",1351958138160,chat-5-01
5,instruction,6,4,Change the increase to 50% for current other accrued liabilities. What is the average?,"{'num_5': 50, 'num_4': 'four', 'num_1': 20, 'num_2': '200M', 'num_3': 'five', 'year_1': 2018, 'year_2': 2021, 'industry_1': {'mention': 'services-packaged software', 'name': 'SERVICES-PREPACKAGED SOFTWARE'}, 'concept_1': {'mention': 'estimated revenue expected to be recognized in the future for backlog related performance obligations', 'name': 'us-gaap:RevenueRemainingPerformanceObligation'}, 'concept_2': {'mention': 'current other accrued liabilities', 'name': 'us-gaap:OtherAccruedLiabilitiesCurrent'}}","{'var_q4_p1': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:RevenueRemainingPerformanceObligation"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q4_p2': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:OtherAccruedLiabilitiesCurrent"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q4_p1 = query_b044q01p01_p02(concept_1, industry_1, start=year_1, end=year_2)', 'var_q4_p2 = query_b044q01p01_p02(concept_2, industry_1, start=year_1, end=year_2)', ""var_q4_p3 = const_mul(var_q4_p1, columns=':', idx=':', source='custom', step=var_q4_p2, val='1.2')"", ""var_q4_p4 = const_mul(var_q4_p2, columns=':', idx=':', source='custom', step=var_q4_p3, val='1.5')"", ""var_q4_p5 = mean(var_q4_p4, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q4_p6 = loc_filter(var_q4_p5, axis='rows', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q4_p5, val='200m')"", ""var_q4_p7 = intersect(var_q4_p3, axis='rows', dfs=[var_q4_p6], level=0)"", ""var_q4_p8 = sum(var_q4_p7, axis='columns', keep_col=false, level=null)"", ""var_q4_p9 = sort(var_q4_p8, ascending=False, axis='rows', by=[null])"", ""var_q4_p10 = k_end(var_q4_p9, axis='rows', direction='first', k='5', reverse=false)"", ""var_q4_p11 = mean(var_q4_p10, axis='columns', keep_col=false, level=null, skipna=true)""]",1351651680000,chat-5-01
5,instruction,6,5,Adjust the increase for estimated revenue expected to be recognized in the future for backlog related performance obligations to 45% from 2018 to 2020 and maintain the same increment rate for the rest. What is the average?,"{'num_6': 45, 'year_3': 2020, 'num_5': 50, 'num_4': 'four', 'num_1': 20, 'num_2': '200M', 'num_3': 'five', 'year_1': 2018, 'year_2': 2021, 'industry_1': {'mention': 'services-packaged software', 'name': 'SERVICES-PREPACKAGED SOFTWARE'}, 'concept_1': {'mention': 'estimated revenue expected to be recognized in the future for backlog related performance obligations', 'name': 'us-gaap:RevenueRemainingPerformanceObligation'}, 'concept_2': {'mention': 'current other accrued liabilities', 'name': 'us-gaap:OtherAccruedLiabilitiesCurrent'}}","{'var_q5_p1': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:RevenueRemainingPerformanceObligation"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q5_p2': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:OtherAccruedLiabilitiesCurrent"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q5_p1 = query_b044q01p01_p02(concept_1, industry_1, start=year_1, end=year_2)', 'var_q5_p2 = query_b044q01p01_p02(concept_2, industry_1, start=year_1, end=year_2)', 'var_q5_p3 = const_mul(var_q5_p1, columns=""[2018, 2019, 2020, ]"", idx="":, :"", source=\'custom\', step=var_q5_p2, val=\'1.45\')', 'var_q5_p4 = const_mul(var_q5_p3, columns=""[2021, ]"", idx="":, :"", source=\'custom\', step=var_q5_p3, val=\'1.2\')', 'var_q5_p5 = const_mul(var_q5_p2, columns="":"", idx="":, :"", source=\'custom\', step=var_q5_p4, val=\'1.5\')', ""var_q5_p6 = mean(var_q5_p5, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q5_p7 = loc_filter(var_q5_p6, axis='rows', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q5_p6, val='200m')"", ""var_q5_p8 = intersect(var_q5_p4, axis='rows', dfs=[var_q5_p7], level=0)"", ""var_q5_p9 = sum(var_q5_p8, axis='columns', keep_col=false, level=null)"", ""var_q5_p10 = sort(var_q5_p9, ascending=False, axis='rows', by=[null])"", ""var_q5_p11 = k_end(var_q5_p10, axis='rows', direction='first', k='5', reverse=false)"", ""var_q5_p12 = mean(var_q5_p11, axis='columns', keep_col=false, level=null, skipna=true)""]",1545414330000,chat-5-01
5,instruction,6,6,Adjust the current other accrued liabilities's cutoff threshold to 100M. What is the average?,"{'num_7': '100M', 'num_6': 45, 'year_3': 2020, 'num_5': 50, 'num_4': 'four', 'num_1': 20, 'num_2': '200M', 'num_3': 'five', 'year_1': 2018, 'year_2': 2021, 'industry_1': {'mention': 'services-packaged software', 'name': 'SERVICES-PREPACKAGED SOFTWARE'}, 'concept_1': {'mention': 'estimated revenue expected to be recognized in the future for backlog related performance obligations', 'name': 'us-gaap:RevenueRemainingPerformanceObligation'}, 'concept_2': {'mention': 'current other accrued liabilities', 'name': 'us-gaap:OtherAccruedLiabilitiesCurrent'}}","{'var_q6_p1': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:RevenueRemainingPerformanceObligation"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q6_p2': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:OtherAccruedLiabilitiesCurrent"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q6_p1 = query_b044q01p01_p02(concept_1, industry_1, start=year_1, end=year_2)', 'var_q6_p2 = query_b044q01p01_p02(concept_2, industry_1, start=year_1, end=year_2)', 'var_q6_p3 = const_mul(var_q6_p1, columns=""[2018, 2019, 2020, ]"", idx="":, :"", source=\'custom\', step=var_q6_p2, val=\'1.45\')', 'var_q6_p4 = const_mul(var_q6_p3, columns=""[2021, ]"", idx="":, :"", source=\'custom\', step=var_q6_p3, val=\'1.2\')', 'var_q6_p5 = const_mul(var_q6_p2, columns="":"", idx="":, :"", source=\'custom\', step=var_q6_p4, val=\'1.5\')', ""var_q6_p6 = mean(var_q6_p5, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q6_p7 = loc_filter(var_q6_p6, axis='rows', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q6_p6, val='100m')"", ""var_q6_p8 = intersect(var_q6_p4, axis='rows', dfs=[var_q6_p7], level=0)"", ""var_q6_p9 = mean(var_q6_p8, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q6_p10 = sort(var_q6_p9, ascending=False, axis='rows', by=[null])"", ""var_q6_p11 = k_end(var_q6_p10, axis='rows', direction='first', k='5', reverse=false)"", ""var_q6_p12 = mean(var_q6_p11, axis='columns', keep_col=false, level=null, skipna=true)""]",510949321333.33,chat-5-01
5,instruction,6,7,Remove companies with average current other accrued liabilities below 10M from the analysis as well. What is the average?,"{'num_8': '10M', 'num_7': '100M', 'num_6': 45, 'year_3': 2020, 'num_5': 50, 'num_4': 'four', 'num_1': 20, 'num_2': '200M', 'num_3': 'five', 'year_1': 2018, 'year_2': 2021, 'industry_1': {'mention': 'services-packaged software', 'name': 'SERVICES-PREPACKAGED SOFTWARE'}, 'concept_1': {'mention': 'estimated revenue expected to be recognized in the future for backlog related performance obligations', 'name': 'us-gaap:RevenueRemainingPerformanceObligation'}, 'concept_2': {'mention': 'current other accrued liabilities', 'name': 'us-gaap:OtherAccruedLiabilitiesCurrent'}}","{'var_q7_p1': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:RevenueRemainingPerformanceObligation"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q7_p2': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:OtherAccruedLiabilitiesCurrent"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q7_p1 = query_b044q01p01_p02(concept_1, industry_1, start=year_1, end=year_2)', 'var_q7_p2 = query_b044q01p01_p02(concept_2, industry_1, start=year_1, end=year_2)', 'var_q7_p3 = const_mul(var_q7_p1, columns=""[2018, 2019, 2020, ]"", idx="":, :"", source=\'custom\', step=var_q7_p2, val=\'1.45\')', 'var_q7_p4 = const_mul(var_q7_p3, columns=""[2021, ]"", idx="":, :"", source=\'custom\', step=var_q7_p3, val=\'1.2\')', 'var_q7_p5 = const_mul(var_q7_p2, columns="":"", idx="":, :"", source=\'custom\', step=var_q7_p4, val=\'1.5\')', ""var_q7_p6 = mean(var_q7_p5, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q7_p7 = loc_filter(var_q7_p6, axis='rows', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q7_p6, val='100m')"", ""var_q7_p8 = loc_filter(var_q7_p7, axis='rows', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q7_p7, val='10m')"", ""var_q7_p9 = intersect(var_q7_p4, axis='rows', dfs=[var_q7_p8], level=0)"", ""var_q7_p10 = sum(var_q7_p9, axis='columns', keep_col=false, level=null)"", ""var_q7_p11 = sort(var_q7_p10, ascending=False, axis='rows', by=[null])"", ""var_q7_p12 = k_end(var_q7_p11, axis='rows', direction='first', k='5', reverse=false)"", ""var_q7_p13 = mean(var_q7_p12, axis='columns', keep_col=false, level=null, skipna=true)""]",1532029523000,chat-5-01
5,instruction,6,8,Decrease all companies' current other accrued liabilities by 50% from their reported values from 2019 to 2021. Maintain the adjusted values for the rest of the data. What is the average?,"{'num_9': 50, 'year_4': 2019, 'num_8': '10M', 'num_7': '100M', 'num_6': 45, 'year_3': 2020, 'num_5': 50, 'num_4': 'four', 'num_1': 20, 'num_2': '200M', 'num_3': 'five', 'year_1': 2018, 'year_2': 2021, 'industry_1': {'mention': 'services-packaged software', 'name': 'SERVICES-PREPACKAGED SOFTWARE'}, 'concept_1': {'mention': 'estimated revenue expected to be recognized in the future for backlog related performance obligations', 'name': 'us-gaap:RevenueRemainingPerformanceObligation'}, 'concept_2': {'mention': 'current other accrued liabilities', 'name': 'us-gaap:OtherAccruedLiabilitiesCurrent'}}","{'var_q8_p1': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:RevenueRemainingPerformanceObligation"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q8_p2': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:OtherAccruedLiabilitiesCurrent"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q8_p1 = query_b044q01p01_p02(concept_1, industry_1, start=year_1, end=year_2)', 'var_q8_p2 = query_b044q01p01_p02(concept_2, industry_1, start=year_1, end=year_2)', 'var_q8_p3 = const_mul(var_q8_p1, columns=""[2018, 2019, 2020, ]"", idx="":, :"", source=\'custom\', step=var_q8_p2, val=\'1.45\')', 'var_q8_p4 = const_mul(var_q8_p3, columns=""[2021, ]"", idx="":, :"", source=\'custom\', step=var_q8_p3, val=\'1.2\')', 'var_q8_p5 = const_mul(var_q8_p2, columns=""[2018, ]"", idx="":, :"", source=\'custom\', step=var_q8_p4, val=\'1.5\')', 'var_q8_p6 = const_mul(var_q8_p5, columns=""[2019, 2020, 2021, ]"", idx="":, :"", source=\'custom\', step=var_q8_p5, val=\'0.5\')', ""var_q8_p7 = mean(var_q8_p6, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q8_p8 = loc_filter(var_q8_p7, axis='rows', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q8_p7, val='100m')"", ""var_q8_p9 = loc_filter(var_q8_p8, axis='rows', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q8_p8, val='10m')"", ""var_q8_p10 = intersect(var_q8_p4, axis='rows', dfs=[var_q8_p9], level=0)"", ""var_q8_p11 = sum(var_q8_p10, axis='columns', keep_col=false, level=null)"", ""var_q8_p12 = sort(var_q8_p11, ascending=False, axis='rows', by=[null])"", ""var_q8_p13 = k_end(var_q8_p12, axis='rows', direction='first', k='5', reverse=false)"", ""var_q8_p14 = mean(var_q8_p13, axis='columns', keep_col=false, level=null, skipna=true)""]",19230500000,chat-5-01
5,instruction,6,9,What about the average of the top three?,"{'num_10': 'three', 'num_9': 50, 'year_4': 2019, 'num_8': '10M', 'num_7': '100M', 'num_6': 45, 'year_3': 2020, 'num_5': 50, 'num_4': 'four', 'num_1': 20, 'num_2': '200M', 'num_3': 'five', 'year_1': 2018, 'year_2': 2021, 'industry_1': {'mention': 'services-packaged software', 'name': 'SERVICES-PREPACKAGED SOFTWARE'}, 'concept_1': {'mention': 'estimated revenue expected to be recognized in the future for backlog related performance obligations', 'name': 'us-gaap:RevenueRemainingPerformanceObligation'}, 'concept_2': {'mention': 'current other accrued liabilities', 'name': 'us-gaap:OtherAccruedLiabilitiesCurrent'}}","{'var_q9_p1': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:RevenueRemainingPerformanceObligation"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q9_p2': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:OtherAccruedLiabilitiesCurrent"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q9_p1 = query_b044q01p01_p02(concept_1, industry_1, start=year_1, end=year_2)', 'var_q9_p2 = query_b044q01p01_p02(concept_2, industry_1, start=year_1, end=year_2)', 'var_q9_p3 = const_mul(var_q9_p1, columns=""[2018, 2019, 2020, ]"", idx="":, :"", source=\'custom\', step=var_q9_p2, val=\'1.45\')', 'var_q9_p4 = const_mul(var_q9_p3, columns=""[2021, ]"", idx="":, :"", source=\'custom\', step=var_q9_p3, val=\'1.2\')', 'var_q9_p5 = const_mul(var_q9_p2, columns=""[2018, ]"", idx="":, :"", source=\'custom\', step=var_q9_p4, val=\'1.5\')', 'var_q9_p6 = const_mul(var_q9_p5, columns=""[2019, 2020, 2021, ]"", idx="":, :"", source=\'custom\', step=var_q9_p5, val=\'0.5\')', ""var_q9_p7 = mean(var_q9_p6, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q9_p8 = loc_filter(var_q9_p7, axis='rows', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q9_p7, val='100m')"", ""var_q9_p9 = loc_filter(var_q9_p8, axis='rows', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q9_p8, val='10m')"", ""var_q9_p10 = intersect(var_q9_p4, axis='rows', dfs=[var_q9_p9], level=0)"", ""var_q9_p11 = sum(var_q9_p10, axis='columns', keep_col=false, level=null)"", ""var_q9_p12 = sort(var_q9_p11, ascending=False, axis='rows', by=[null])"", ""var_q9_p13 = k_end(var_q9_p12, axis='rows', direction='first', k=3, reverse=false)"", ""var_q9_p14 = mean(var_q9_p13, axis='columns', keep_col=false, level=null, skipna=true)""]",26465000000,chat-5-01
5,instruction,6,10,"After all the steps you have taken, how many companies are not in the top three?","{'num_10': 'three', 'num_9': 50, 'year_4': 2019, 'num_8': '10M', 'num_7': '100M', 'num_6': 45, 'year_3': 2020, 'num_5': 50, 'num_4': 'four', 'num_1': 20, 'num_2': '200M', 'num_3': 'five', 'year_1': 2018, 'year_2': 2021, 'industry_1': {'mention': 'services-packaged software', 'name': 'SERVICES-PREPACKAGED SOFTWARE'}, 'concept_1': {'mention': 'estimated revenue expected to be recognized in the future for backlog related performance obligations', 'name': 'us-gaap:RevenueRemainingPerformanceObligation'}, 'concept_2': {'mention': 'current other accrued liabilities', 'name': 'us-gaap:OtherAccruedLiabilitiesCurrent'}}","{'var_q10_p1': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:RevenueRemainingPerformanceObligation"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value', 'var_q10_p2': 'WITH [2018, 2019, 2020, 2021] AS years MATCH (o:Company)-[:HAS_CONCEPT]->(c:Concept)-[:HAS_FACT]->(f:Fact), (o)-[:BELONG_TO_INDUSTRY_OF]->(i:Industry) WHERE f.year in years AND c.name = ""us-gaap:OtherAccruedLiabilitiesCurrent"" AND i.name = ""SERVICES-PREPACKAGED SOFTWARE"" RETURN o.name AS company, c.name AS concept, f.year AS year, f.number AS value'}","['var_q10_p1 = query_b044q01p01_p02(concept_1, industry_1, start=year_1, end=year_2)', 'var_q10_p2 = query_b044q01p01_p02(concept_2, industry_1, start=year_1, end=year_2)', 'var_q10_p3 = const_mul(var_q10_p1, columns=""[2018, 2019, 2020, ]"", idx="":, :"", source=\'custom\', step=var_q10_p2, val=\'1.45\')', 'var_q10_p4 = const_mul(var_q10_p3, columns=""[2021, ]"", idx="":, :"", source=\'custom\', step=var_q10_p3, val=\'1.2\')', 'var_q10_p5 = const_mul(var_q10_p2, columns=""[2018, ]"", idx="":, :"", source=\'custom\', step=var_q10_p4, val=\'1.5\')', 'var_q10_p6 = const_mul(var_q10_p5, columns=""[2019, 2020, 2021, ]"", idx="":, :"", source=\'custom\', step=var_q10_p5, val=\'0.5\')', ""var_q10_p7 = mean(var_q10_p6, axis='columns', keep_col=false, level=null, skipna=true)"", ""var_q10_p8 = loc_filter(var_q10_p7, axis='rows', columns=':', condition='le', idx=':', operation='all', source='custom', step=var_q10_p7, val='100m')"", ""var_q10_p9 = loc_filter(var_q10_p8, axis='rows', columns=':', condition='ge', idx=':', operation='all', source='custom', step=var_q10_p8, val='10m')"", ""var_q10_p10 = intersect(var_q10_p4, axis='rows', dfs=[var_q10_p9], level=0)"", ""var_q10_p11 = sum(var_q10_p10, axis='columns', keep_col=false, level=null)"", ""var_q10_p12 = sort(var_q10_p11, ascending=False, axis='rows', by=[null])"", ""var_q10_p13 = k_end(var_q10_p12, axis='rows', direction='first', k=3, reverse=true)"", ""var_q10_p14 = count(var_q10_p13, axis='rows')""]",9,chat-5-01
